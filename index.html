<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>IMPACT</title>
  <style>
    body { margin:0; font-family:Arial, sans-serif; background:#fff; color:#000; }
    header { display:flex; justify-content:space-between; align-items:center; padding:15px 20px; border-bottom:1px solid #ddd; }
    header h1 { font-size:22px; margin:0; }
    .hamburger { font-size:24px; cursor:pointer; }

    /* 햄버거 네비 */
    .nav-overlay {
      position:fixed; top:0; right:-100%; width:100%; height:100%;
      background:#f9f9f5; color:#000; z-index:999;
      display:flex; flex-direction:column; padding:30px;
      transition: right 0.3s ease-in-out;
    }
    .nav-overlay.active { right:0; }
    .nav-top { display:flex; justify-content:space-between; align-items:center; }
    .nav-close { font-size:28px; cursor:pointer; }
    .search-input {
      width:100%; border:none; border-bottom:2px solid #000;
      background:transparent; padding:15px 0; font-size:18px; outline:none;
    }
    .nav-menu { margin-top:40px; }
    .nav-menu a {
      color:#000; font-size:28px; font-weight:bold; display:block;
      margin:15px 0; text-decoration:none; cursor:pointer;
    }
    .nav-footer {
      margin-top:auto; padding-top:20px; border-top:1px solid #ddd;
      display:flex; gap:15px; font-size:13px; font-weight:bold;
    }
    .nav-footer a { color:#000; text-decoration:none; }

    /* 카테고리 섹션 */
    section { padding:30px 20px; }
    section h2 { font-size:24px; margin-bottom:20px; border-bottom:2px solid #000; display:inline-block; padding-bottom:5px; }
    .post-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(250px,1fr)); gap:20px; }
    .post-card {
      border:1px solid #eee; border-radius:8px; overflow:hidden;
      background:#fff; box-shadow:0 2px 6px rgba(0,0,0,0.05);
      display:flex; flex-direction:column; cursor:pointer;
      transition:transform 0.2s;
    }
    .post-card:hover { transform:translateY(-3px); }
    .post-thumb img { width:100%; height:180px; object-fit:cover; }
    .post-content { padding:15px; }
    .category-tag {
      display:inline-block; padding:3px 8px; border-radius:4px;
      font-size:12px; color:#fff; margin-bottom:8px;
    }
    .category-tag.tech { background:#4CAF50; }
    .category-tag.eat { background:#FF5722; }
    .category-tag.style { background:#9C27B0; }
    .category-tag.culture { background:#2196F3; }
    .category-tag.life { background:#FFC107; color:#000; }
    .category-tag.editors-pick { background:#E91E63; }
    .post-title { font-size:18px; font-weight:bold; margin:0 0 10px; display:block; color:#000; text-decoration:none; }
    .post-meta { font-size:12px; color:#666; margin-bottom:10px; display:flex; gap:10px; align-items:center; }
    .post-meta img { width:20px; height:20px; border-radius:50%; }
    .post-excerpt { font-size:14px; color:#444; }
    .loading { text-align:center; color:#888; padding:30px; }

    /* 맨 위 버튼 */
    #scrollTopBtn {
      position:fixed; bottom:20px; right:20px;
      background:#fff; color:#000; border:1px solid #000;
      border-radius:50%; width:40px; height:40px;
      display:none; cursor:pointer; font-size:20px;
    }
  </style>
</head>
<body>
  <header>
    <h1>IMPACT</h1>
    <div class="hamburger">☰</div>
  </header>

  <!-- 햄버거 메뉴 -->
  <div class="nav-overlay" id="nav">
    <div class="nav-top">
      <input type="text" class="search-input" placeholder="검색어 입력">
      <div class="nav-close" id="navClose">×</div>
    </div>
    <div class="nav-menu">
      <a onclick="scrollToSection('tech')">TECH</a>
      <a onclick="scrollToSection('eat')">EAT</a>
      <a onclick="scrollToSection('style')">STYLE</a>
      <a onclick="scrollToSection('culture')">CULTURE</a>
      <a onclick="scrollToSection('life')">LIFE</a>
      <a onclick="scrollToSection('editors-pick')">EDITOR'S PICK</a>
      <a href="about.html">ABOUT</a>
    </div>
    <div class="nav-footer">
      <a href="about.html">ABOUT</a> | 
      <a href="#">EDITORS</a> | 
      <a href="#">NEWSLETTER</a> | 
      <a href="#">INSTAGRAM</a>
    </div>
  </div>

  <!-- 카테고리 섹션 -->
  <section id="tech"><h2>TECH</h2><div id="tech-grid" class="post-grid"></div></section>
  <section id="eat"><h2>EAT</h2><div id="eat-grid" class="post-grid"></div></section>
  <section id="style"><h2>STYLE</h2><div id="style-grid" class="post-grid"></div></section>
  <section id="culture"><h2>CULTURE</h2><div id="culture-grid" class="post-grid"></div></section>
  <section id="life"><h2>LIFE</h2><div id="life-grid" class="post-grid"></div></section>
  <section id="editors-pick"><h2>EDITOR'S PICK</h2><div id="editors-pick-grid" class="post-grid"></div></section>

  <!-- 맨 위 버튼 -->
  <button id="scrollTopBtn">↑</button>

  <script>
    const site = "impactceo0.wordpress.com";
    const categories = {
      "culture": 1098,
      "eat": 123073,
      "editors-pick": 259543,
      "life": 124,
      "style": 2286,
      "tech": 318
    };
    let page = { tech:1, eat:1, style:1, culture:1, life:1, "editors-pick":1 };

    async function loadPosts(category, append=false){
      const catId = categories[category];
      const grid = document.getElementById(category+"-grid");
      if(!append) grid.innerHTML = "<div class='loading'>로딩 중...</div>";

      try {
        const res = await fetch(`https://public-api.wordpress.com/wp/v2/sites/${site}/posts?categories=${catId}&per_page=6&page=${page[category]}&_embed`);
        if(!res.ok) throw new Error("API 실패");
        const posts = await res.json();

        if(posts.length === 0 && !append){
          grid.innerHTML = "<div class='loading'>아직 이 카테고리에 글이 없습니다.</div>";
          return;
        }
        if(!append) grid.innerHTML = "";

        posts.forEach(post => {
          let thumb = "";
          if(post._embedded?.['wp:featuredmedia']?.[0]){
            thumb = `<div class="post-thumb"><img src="${post._embedded['wp:featuredmedia'][0].source_url}" alt=""></div>`;
          }
          let author = post._embedded?.author ? post._embedded.author[0].name : "익명";
          let avatar = post._embedded?.author ? post._embedded.author[0].avatar_urls["48"] : "";
          let excerpt = post.excerpt.rendered.replace(/<[^>]+>/g,"").slice(0,120);

          let card = `
            <div class="post-card" onclick="openPost(${post.id})">
              ${thumb}
              <div class="post-content">
                <div class="category-tag ${category}">${category.toUpperCase()}</div>
                <div class="post-title">${post.title.rendered}</div>
                <div class="post-meta">
                  <img src="${avatar}"> <span>${author}</span>
                  <span>${new Date(post.date).toLocaleDateString()}</span>
                </div>
                <div class="post-excerpt">${excerpt}...</div>
              </div>
            </div>
          `;
          grid.innerHTML += card;
        });
      } catch(err){
        console.error(err);
        grid.innerHTML = "<div class='loading'>글을 불러오는 중 오류가 발생했습니다.</div>";
      }
    }

    // 초기 로딩
    Object.keys(categories).forEach(loadPosts);

    // 무한 스크롤
    window.addEventListener("scroll", () => {
      if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 100){
        Object.keys(categories).forEach(cat=>{
          page[cat]++;
          loadPosts(cat, true);
        });
      }
    });

    // 메뉴 토글
    const nav = document.getElementById("nav");
    document.querySelector(".hamburger").onclick = () => nav.classList.add("active");
    document.getElementById("navClose").onclick = () => nav.classList.remove("active");

    // 스크롤 이동
    function scrollToSection(id){
      document.getElementById(id).scrollIntoView({behavior:"smooth"});
      nav.classList.remove("active");
    }

    // 맨 위 버튼
    const btn = document.getElementById("scrollTopBtn");
    window.addEventListener("scroll", ()=>{
      btn.style.display = window.scrollY > 300 ? "block" : "none";
    });
    btn.onclick = ()=> window.scrollTo({top:0, behavior:"smooth"});

    // 글 클릭 → post.html 이동
    function openPost(id){
      window.location.href = `post.html?id=${id}`;
    }
  </script>
</body>
</html>
