
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IMPACT ‚Äì MAKE A IMPACT</title>
  <meta name="description" content="Innovation Management Passion Acceleration Creativity Technology">
  <meta name="naver-site-verification" content="75a4e73cbf2b7f3acb2c71fac1ea821a9c13ae85" />

  <script async src="https://www.googletagmanager.com/gtag/js?id=G-D0DVTWYNGN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D0DVTWYNGN');
  </script>
  <link rel="icon" href="logo.png" type="image/png">
  <link rel="apple-touch-icon" href="logo.png">
  <link rel="apple-touch-icon" sizes="152x152" href="logo.png">
  <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
  <link rel="apple-touch-icon" sizes="167x167" href="logo.png">

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="IMPACT">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;800;900&display=swap" rel="stylesheet">
  <style>
  *, *::before, *::after { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0;
    font-family: "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Apple SD Gothic Neo", sans-serif;
    background: #f6f7f9;
    color: #111;
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    scroll-behavior: smooth;
    overscroll-behavior-y: contain;
    -webkit-tap-highlight-color: transparent;
    transition: background-color 0.4s cubic-bezier(0.4, 0, 0.2, 1), color 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  body.dark-mode {
    background: #0d0d0d;
    color: #e8e8e8;
  }

  body.dark-mode .header {
    background: rgba(20,20,20,0.95);
    border-bottom-color: rgba(255,255,255,0.08);
  }

  body.dark-mode .card,
  body.dark-mode .btn {
    background: #1a1a1a;
    border-color: rgba(255,255,255,0.12);
    color: #e8e8e8;
  }

  body.dark-mode .btn:hover {
    background: #252525;
  }

  body.dark-mode .card h3,
  body.dark-mode .category-title {
    color: #f5f5f5;
  }

  body.dark-mode .nav-overlay {
    background: rgba(20,20,20,0.98);
  }

  body.dark-mode .nav-list li {
    color: #e8e8e8;
    border-bottom-color: rgba(255,255,255,0.08);
  }

  body.dark-mode .category-overlay,
  body.dark-mode .post-overlay,
  body.dark-mode .search-overlay,
  body.dark-mode .about-page,
  body.dark-mode .editors-overlay {
    background: #0d0d0d;
    color: #e8e8e8;
  }

  body.dark-mode .to-top {
    background: #1a1a1a;
    color: #e8e8e8;
    border-color: rgba(255,255,255,0.12);
  }

  body.dark-mode .post-content {
    color: #e8e8e8;
  }

  body.dark-mode .post-content p,
  body.dark-mode .post-content h1,
  body.dark-mode .post-content h2,
  body.dark-mode .post-content h3,
  body.dark-mode .post-content h4,
  body.dark-mode .post-content li,
  body.dark-mode .post-content span,
  body.dark-mode .post-content div {
    color: #ffffff !important;
  }

  body.dark-mode .meta,
  body.dark-mode .category-sub,
  body.dark-mode .editor-bio,
  body.dark-mode .post-meta-info {
    color: #cccccc !important;
  }

  body.dark-mode .post-info h1 {
    color: #f5f5f5 !important;
  }

  body.dark-mode .hero-overlay {
    background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
  }

  body.dark-mode .nav-search {
    background: #1a1a1a;
  }

  body.dark-mode .nav-search input {
    color: #e8e8e8;
  }

  body.dark-mode .nav-footer-links a {
    color: #e8e8e8;
  }

  body.dark-mode .search-bar {
    background: #1a1a1a;
  }

  body.dark-mode .search-bar input[type="search"] {
    color: #e8e8e8;
  }

  body.dark-mode .pagination button {
    background: #1a1a1a;
    color: #e8e8e8;
    border-color: rgba(255,255,255,0.12);
  }

  body.dark-mode .editor-card {
    background: #1a1a1a;
    border-color: rgba(255,255,255,0.12);
  }

  body.dark-mode .page-header {
    border-bottom-color: rgba(255,255,255,0.08);
  }

  body.dark-mode .post-header-bar {
    background: rgba(20,20,20,0.95);
    border-bottom-color: rgba(255,255,255,0.08);
  }

  body.dark-mode .post-header-bar .logo {
    color: #e8e8e8 !important;
  }

  body.dark-mode .post-header-bar .btn {
    color: #e8e8e8 !important;
    background: rgba(255,255,255,0.08);
    border-color: rgba(255,255,255,0.12);
  }

  body.dark-mode .hero-author,
  body.dark-mode .hero-date {
    color: #e8e8e8 !important;
  }

  body.dark-mode .date {
    color: #cccccc !important;
  }

  body.dark-mode .page-header h2 {
    color: #f5f5f5;
  }

  body.dark-mode .about-page p,
  body.dark-mode .about-page h3,
  body.dark-mode .about-page h4,
  body.dark-mode .about-page div {
    color: #e8e8e8 !important;
  }

  body.dark-mode .about-page a {
    color: #ff8c5a !important;
  }

  body.dark-mode .roadmap-item h4 {
    color: #f5f5f5 !important;
  }

  body.dark-mode .roadmap-item p {
    color: #cccccc !important;
  }

  body.dark-mode .roadmap-item span {
    color: #e8e8e8 !important;
  }

  body.dark-mode .copyright-notice {
    color: #cccccc !important;
  }

  body.dark-mode .author-profile-section {
    background: #1a1a1a;
    border-color: rgba(255,255,255,0.12);
  }

  body.dark-mode .author-profile-name {
    color: #f5f5f5 !important;
  }

  body.dark-mode .author-profile-bio {
    color: #cccccc !important;
  }

  body.dark-mode .image-modal {
    background: rgba(0,0,0,0.95);
  }

  a { color: inherit; text-decoration: none; }
  img { display: block; max-width: 100%; height: auto; }
  input[type="search"]::-webkit-search-cancel-button { cursor: pointer; }
  .wrap { max-width: 1400px; margin: 0 auto; padding: 0 20px; }
  .hidden { display:none !important; }

  .page-transition {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: #f6f7f9;
    z-index: 10001;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    font-weight: 500;
    color: #111;
  }

  body.dark-mode .page-transition {
    background: #0d0d0d;
    color: #e8e8e8;
  }

  .page-transition.active {
    opacity: 1;
    pointer-events: all;
  }

  .progress-bar {
    position: fixed;
    top: 0;
    left: 0;
    width: 0%;
    height: 3px;
    background: linear-gradient(90deg, #ff6b35, #ff8c5a);
    z-index: 10000;
    transition: width 0.1s ease;
    display: none;
  }

  .progress-bar.active {
    display: block;
  }
  header.header {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1200;
    background: rgba(255,255,255,0.95);
    border-bottom: 1px solid rgba(0,0,0,0.06);
    backdrop-filter: blur(10px);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
  }

  header.header.hide {
    transform: translateY(-100%);
    opacity: 0;
  }

  .post-header-bar {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 9999;
    background: rgba(255,255,255,0.95);
    border-bottom: 1px solid rgba(0,0,0,0.06);
    backdrop-filter: blur(10px);
    transform: translateY(-100%);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    height: 72px;
    display: flex;
    align-items: center;
  }

  .post-header-bar.show {
    transform: translateY(0);
  }

  .header-inner {
    height: 72px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    max-width:1400px;
    margin:0 auto;
    padding: 0 20px;
  }
  .brand { display:flex; gap:12px; align-items:center; }
  .brand .logo {
    display:flex;
    gap:8px;
    align-items:center;
    font-weight:900;
    font-size:26px;
    letter-spacing:1px;
    color:#111;
    cursor:pointer;
    transition: opacity 0.2s ease;
  }
  body.dark-mode .brand .logo {
    color: #e8e8e8;
  }
  
  @media (hover: hover) {
    .brand .logo:hover {
      opacity: 0.7;
    }
  }
  
  .brand .logo:active {
    opacity: 0.7;
  }
  
  .brand .logo.clicked {
    opacity: 1 !important;
  }
  
  .brand .logo .logo-text {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
  .brand .logo .logo-text .main-text {
    line-height: 1;
    letter-spacing: 1px;
  }
  .brand .logo small {
    font-size:11px;
    color:#777;
    font-weight:800;
    display:block;
    line-height:1;
    letter-spacing: 1px;
  }
  body.dark-mode .brand .logo small { color: #cccccc; }
  .header-actions { display:flex; gap:8px; align-items:center; }
  .btn {
    border-radius:10px;
    background:#fff;
    padding:8px 12px;
    border:1px solid rgba(0,0,0,0.08);
    font-weight:700;
    font-size:14px;
    cursor:pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    color: #111;
  }
  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  .btn:active { transform: translateY(1px); }
  .btn.primary {
    background: linear-gradient(135deg,#ff6b35,#ff8c5a);
    color:#fff;
    border:none;
  }

  .icon-btn {
    width: 40px;
    height: 40px;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
  }
  .nav-overlay {
    position: fixed;
    top: 0;
    right: 0;
    bottom: 0;
    width: 400px;
    background: rgba(255,255,255,0.98);
    z-index: 2000;
    padding: 28px;
    transform: translateX(100%);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    overflow-y: auto;
    box-shadow: -4px 0 20px rgba(0,0,0,0.1);
  }

  @media (max-width: 680px) {
    .nav-overlay {
      width: 100vw;
      left: 0;
    }
    
    .nav-close {
      position: relative;
      top: auto;
      right: auto;
      margin: 0 auto 16px;
    }
  }
  .nav-overlay.active { transform: translateX(0); }
  .nav-close {
    position: absolute;
    top: 24px;
    right: 24px;
    background: none;
    border: none;
    font-size: 32px;
    cursor: pointer;
    color: #111;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
  }
  body.dark-mode .nav-close {
    color: #e8e8e8;
  }
  .nav-close:hover {
    background: rgba(0,0,0,0.05);
    transform: rotate(90deg);
  }
  body.dark-mode .nav-close:hover {
    background: rgba(255,255,255,0.1);
  }
  .nav-search {
    display: flex;
    align-items: center;
    gap: 8px;
    background: #f0f0f0;
    border-radius: 50px;
    padding: 8px 16px;
    margin-bottom: 20px;
  }
  .nav-search input {
    flex: 1;
    border: none;
    outline: none;
    background: transparent;
    font-size: 16px;
    color: #111;
  }
  .nav-list {
    list-style: none;
    padding: 0;
    margin: 20px 0;
  }
  .nav-list li {
    padding: 16px 0;
    font-weight: 800;
    font-size: 24px;
    cursor: pointer;
    transition: all 0.3s ease;
    border-bottom: 1px solid rgba(0,0,0,0.06);
  }
  .nav-list li:hover {
    transform: translateX(10px);
    color: #ff6b35;
  }
  .nav-footer-links {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-top: 32px;
  }
  .nav-footer-links a {
    font-weight: 700;
    font-size: 16px;
    color: #666;
    transition: all 0.3s ease;
  }
  body.dark-mode .nav-footer-links a {
    color: #e8e8e8;
  }
  .nav-footer-links a:hover {
    color: #ff6b35;
    transform: translateX(5px);
  }
  .home {
    margin-top: 96px;
    padding-bottom: 80px;
  }

  .magazine-row {
    display: grid;
    grid-template-columns: 1.2fr 1fr;
    gap: 20px;
    margin-bottom: 28px;
    max-width: 1400px;
    margin-left: auto;
    margin-right: auto;
    padding: 0 20px;
  }

  .magazine-row.reverse {
    grid-template-columns: 1fr 1.2fr;
  }

  .magazine-large {
    position: relative;
    border-radius: 16px;
    overflow: hidden;
    cursor: pointer;
    min-height: 500px;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .magazine-large:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 28px rgba(0,0,0,0.15);
  }

  .magazine-large .hero {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    inset: 0;
  }

  .hero-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    padding: 28px;
    color: #fff;
  }

  .hero-title {
    font-size: 32px;
    font-weight: 900;
    margin: 0 0 12px;
    line-height: 1.3;
  }

  .magazine-small-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 18px;
  }
  .card {
    background: #fff;
    border-radius: 14px;
    overflow: hidden;
    border: 1px solid rgba(0,0,0,0.06);
    cursor: pointer;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
  }
  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 10px 24px rgba(0,0,0,0.12);
  }
  .card .thumb {
    width: 100%;
    height: 220px;
    overflow: hidden;
    flex-shrink: 0;
  }
  .card .thumb img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }
  .card:hover .thumb img {
    transform: scale(1.05);
  }
  .card-body {
    padding: 18px;
    flex: 1;
    display: flex;
    flex-direction: column;
  }
  .cat-row {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
    margin-bottom: 10px;
  }
  .cat-badge {
    padding: 4px 10px;
    border-radius: 5px;
    font-size: 11px;
    font-weight: 800;
    color: #fff;
  }
  .card h3 {
    font-size: 18px;
    font-weight: 800;
    margin: 0 0 12px;
    line-height: 1.4;
    flex: 1;
  }
  .meta {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 13px;
    color: #666;
    margin-top: auto;
  }
  body.dark-mode .meta {
    color: #cccccc;
  }
  .author-name {
    font-weight: 700;
  }
  .cat-badge {
    padding: 6px 10px;
    border-radius: 6px;
    font-weight: 800;
    font-size: 12px;
    color: #fff;
    margin-bottom: 8px;
  }
  .hero-cats {
    position: absolute;
    right: 16px;
    bottom: 16px;
    display: flex;
    gap: 6px;
  }
  .cat-tech{ background:#1e90ff; }
  .cat-eat{ background:#ff6347; }
  .cat-style{ background:#32cd32; }
  .cat-culture{ background:#8a2be2; }
  .cat-life{ background:#ffa500; color:#000; }
  .cat-editors-pick{ background:#ff1493; }
  .category-overlay, .post-overlay, .search-overlay, .about-page, .editors-overlay {
    display:none;
    position:fixed;
    inset:0;
    background:#fff;
    z-index:1800;
    overflow:auto;
    padding:28px;
    animation: overlayIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  .post-overlay {
    z-index:1900;
    padding: 0;
    touch-action: pan-y;
  }
  .category-overlay.active, .post-overlay.active, .search-overlay.active, .about-page.active, .editors-overlay.active { display:block; }
  @keyframes overlayIn { from { opacity:0; transform: translateY(20px); } to { opacity:1; transform: translateY(0); } }
  @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .roadmap-item:hover {
    transform: translateX(5px);
    transition: transform 0.3s ease;
  }
  .category-top {
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    border-bottom:1px solid rgba(0,0,0,0.06);
    padding-bottom:12px;
  }
  .category-title { font-size:24px; font-weight:900; color:#111; }
  .category-sub { font-size:13px; color:#666; margin-top:4px; }
  body.dark-mode .category-sub { color: #cccccc; }
  .category-grid {
    margin-top:18px;
    display:grid;
    gap:18px;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    padding:20px 0 80px;
  }
  .post-article {
    margin:0 auto;
    max-width:1600px;
    padding: 120px 20px 60px;
  }

  .post-hero-section {
    position: relative;
    margin-bottom: 48px;
  }

  .post-header {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 48px;
    align-items: start;
    min-height: 80vh;
  }

  .post-thumbnail-container {
    position: sticky;
    top: 120px;
    width: 100%;
    height: 70vh;
    min-height: 500px;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: 0 8px 32px rgba(0,0,0,0.12);
  }

  .post-thumbnail {
    width: 100%;
    height: 100%;
  }

  .post-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
    transition: opacity 0.6s ease;
  }

  .post-thumbnail.scrolled img {
    opacity: 0;
    transform: translateY(-20px);
  }

  .post-info-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 40px 0;
  }

  .post-info h1 {
    font-size: 42px;
    font-weight: 900;
    margin: 0 0 24px;
    color: #111;
    line-height: 1.3;
  }

  .post-meta-info {
    display: flex;
    flex-direction: column;
    gap: 16px;
    color: #666;
    font-size: 16px;
    margin-bottom: 32px;
  }
  body.dark-mode .post-meta-info {
    color: #cccccc;
  }

  .post-meta-info .meta-row {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .post-meta-info .author-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    object-fit: cover;
  }

  @media (max-width: 1024px) {
    .post-header {
      grid-template-columns: 1fr;
      gap: 32px;
      min-height: auto;
    }

    .post-thumbnail-container {
      position: relative;
      top: 0;
      height: 60vh;
      min-height: 400px;
    }

    .post-info h1 {
      font-size: 32px;
    }
  }

  @media (max-width: 768px) {
    .post-article {
      padding: 28px 20px 60px;
    }

    .post-header {
      gap: 24px;
    }

    .post-thumbnail-container {
      height: 50vh;
      min-height: 300px;
    }

    .post-info h1 {
      font-size: 28px;
    }

    .post-info-container {
      padding: 20px 0;
    }
  }

  .post-content {
    color: #222;
    line-height: 1.9;
    font-size: 18px;
    max-width: 800px;
    margin: 0 auto;
    padding: 48px 0;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }

  .post-content p {
    margin: 1.8em 0;
    color: #333;
  }

  body.dark-mode .post-content p {
    color: #e8e8e8;
  }

  .post-content h2 {
    margin: 2.5em 0 1em;
    font-size: 28px;
    font-weight: 800;
  }

  .post-content h3 {
    margin: 2em 0 0.8em;
    font-size: 22px;
    font-weight: 700;
  }

  .post-content img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 32px 0;
    border-radius: 12px;
    cursor: pointer;
    transition: transform 0.2s ease;
    pointer-events: none;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
  }

  .post-content img:hover {
    transform: scale(1.02);
  }

  .author-profile-section {
    max-width: 800px;
    margin: 48px auto;
    padding: 24px;
    background: #f9f9f9;
    border-radius: 12px;
    border: 1px solid rgba(0,0,0,0.06);
    display: flex;
    align-items: center;
    gap: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .author-profile-section:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }

  .author-profile-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    object-fit: cover;
    border: 3px solid #ff6b35;
    flex-shrink: 0;
  }

  .author-profile-info {
    flex: 1;
  }

  .author-profile-name {
    font-size: 20px;
    font-weight: 800;
    margin-bottom: 8px;
    color: #111;
  }

  .author-profile-bio {
    font-size: 14px;
    color: #666;
    line-height: 1.6;
  }

  .image-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.95);
    z-index: 10000;
    cursor: zoom-out;
    padding: 20px;
    animation: fadeIn 0.3s ease;
  }

  .image-modal.active {
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .image-modal img {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
    border-radius: 8px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.5);
  }

  .image-modal-close {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 48px;
    height: 48px;
    background: rgba(255,255,255,0.1);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 50%;
    color: #fff;
    font-size: 24px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    z-index: 10001;
  }

  .image-modal-close:hover {
    background: rgba(255,255,255,0.2);
    transform: rotate(90deg);
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .related-posts {
    margin-top: 80px;
    padding-top: 48px;
    border-top: 2px solid rgba(0,0,0,0.1);
    max-width: 1200px;
    margin-left: auto;
    margin-right: auto;
  }

  body.dark-mode .related-posts {
    border-top-color: rgba(255,255,255,0.1);
  }

  .related-posts h3 {
    font-size: 28px;
    font-weight: 900;
    margin-bottom: 32px;
    text-align: left;
  }

  .related-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 24px;
  }

  .related-grid .card h3 {
    text-align: left;
  }

  .search-bar {
    display:flex;
    align-items:center;
    background:#fff;
    border-radius:50px;
    box-shadow:0 6px 20px rgba(0,0,0,0.06);
    padding:6px 10px;
    gap:8px;
  }
  .search-bar input[type="search"] {
    flex:1;
    border:none;
    outline:none;
    font-size:16px;
    padding:12px 14px;
    border-radius:50px;
    background: transparent;
    color: #111;
  }
  .search-bar .close-btn {
    background:none;
    border:none;
    font-size:28px;
    cursor:pointer;
    color:#666;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.3s ease;
  }
  body.dark-mode .search-bar .close-btn {
    color: #e8e8e8;
  }
  .search-bar .close-btn:hover {
    background: rgba(0,0,0,0.05);
    transform: rotate(90deg);
  }
  body.dark-mode .search-bar .close-btn:hover {
    background: rgba(255,255,255,0.1);
  }
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
    margin: 48px 0;
    flex-wrap: wrap;
  }
  .pagination button {
    border: none;
    background: #fff;
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 700;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid rgba(0,0,0,0.08);
  }
  .pagination button:hover:not(:disabled) {
    background: #ff6b35;
    color: #fff;
    transform: translateY(-2px);
  }
  .pagination button.active {
    background: #ff6b35;
    color: #fff;
  }
  .pagination button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
  }
  .editors-overlay {
    padding: 28px;
  }

  .editors-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: 24px;
    margin-top: 24px;
  }

  .editor-card {
    background: #fff;
    border-radius: 14px;
    padding: 24px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    border: 1px solid rgba(0,0,0,0.06);
  }

  .editor-card:hover {
    transform: translateY(-6px);
    box-shadow: 0 10px 24px rgba(0,0,0,0.12);
  }

  .editor-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    object-fit: cover;
    margin: 0 auto 16px;
    border: 3px solid #ff6b35;
  }

  .editor-name {
    font-weight: 800;
    font-size: 18px;
    margin-bottom: 8px;
  }

  .editor-bio {
    font-size: 13px;
    color: #666;
    line-height: 1.5;
  }
  body.dark-mode .editor-bio {
    color: #cccccc;
  }
  .to-top {
    position: fixed;
    bottom: 32px;
    right: 32px;
    width: 56px;
    height: 56px;
    background: #000000;
    color: #ffffff;
    border: none;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
    z-index: 1100;
    opacity: 0;
    transform: translateY(20px);
    pointer-events: none;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 16px rgba(0,0,0,0.1);
  }

  body.dark-mode .to-top {
    background: #ffffff;
    color: #000000;
  }

  .to-top.show {
    opacity: 1;
    transform: translateY(0);
    pointer-events: all;
  }
  .to-top:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  }

  .post-to-top {
    position: fixed;
    bottom: 100px;
    right: 32px;
    width: 56px;
    height: 56px;
    background: #000000;
    color: #ffffff;
    border: none;
    border-radius: 50%;
    font-size: 24px;
    cursor: pointer;
    z-index: 9998;
    opacity: 0;
    transform: translateY(20px);
    pointer-events: none;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 16px rgba(0,0,0,0.1);
  }

  body.dark-mode .post-to-top {
    background: #ffffff;
    color: #000000;
  }

  .post-to-top.show {
    opacity: 1;
    transform: translateY(0);
    pointer-events: all;
  }

  .post-to-top:hover {
    transform: translateY(-4px);
    box-shadow: 0 6px 20px rgba(0,0,0,0.15);
  }

  .site-footer {
    background: #2a2a2a;
    padding: 48px 0 32px;
    color: #fff;
    margin-top: 80px;
  }

  .footer-inner {
    display: grid;
    grid-template-columns: 1fr auto auto;
    gap: 48px;
    align-items: start;
  }

  .footer-brand {
    font-size: 28px;
    font-weight: 900;
    margin-bottom: 16px;
  }

  .footer-links {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .footer-links a {
    font-weight: 700;
    color: #ddd;
    transition: all 0.3s ease;
  }

  .footer-links a:hover {
    color: #ff6b35;
  }

  .theme-toggle {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .theme-toggle-label {
    font-size: 13px;
    color: #aaa;
    font-weight: 600;
  }

  .theme-switch {
    position: relative;
    width: 140px;
    height: 48px;
    background: linear-gradient(145deg, #e0e0e0, #f5f5f5);
    border-radius: 24px;
    cursor: pointer;
    box-shadow:
      inset 2px 2px 5px rgba(0,0,0,0.2),
      inset -2px -2px 5px rgba(255,255,255,0.7);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    overflow: hidden;
  }

  body.dark-mode .theme-switch {
    background: linear-gradient(145deg, #1a1a1a, #2a2a2a);
    box-shadow:
      inset 2px 2px 5px rgba(0,0,0,0.5),
      inset -2px -2px 5px rgba(255,255,255,0.05);
  }

  .theme-switch-text {
    position: absolute;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 16px;
    font-size: 11px;
    font-weight: 800;
    letter-spacing: 0.5px;
    pointer-events: none;
  }

  .theme-switch-text .light-text {
    color: #666;
    text-shadow: 1px 1px 2px rgba(255,255,255,0.8);
    transition: all 0.4s ease;
  }

  .theme-switch-text .dark-text {
    color: #333;
    text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
    transition: all 0.4s ease;
  }

  body.dark-mode .theme-switch-text .light-text {
    color: #555;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
  }

  body.dark-mode .theme-switch-text .dark-text {
    color: #aaa;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
  }

  .theme-switch-slider {
    position: absolute;
    top: 4px;
    left: 4px;
    width: 62px;
    height: 40px;
    background: linear-gradient(145deg, #ffffff, #f0f0f0);
    border-radius: 20px;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow:
      2px 2px 5px rgba(0,0,0,0.2),
      -1px -1px 3px rgba(255,255,255,0.7);
  }

  body.dark-mode .theme-switch-slider {
    left: 74px;
    background: linear-gradient(145deg, #333, #2a2a2a);
    box-shadow:
      2px 2px 5px rgba(0,0,0,0.5),
      -1px -1px 3px rgba(255,255,255,0.05);
  }
  .about-page, .editors-overlay {
    padding: 40px 20px;
  }

  .about-page .wrap {
    max-width: 900px;
  }

  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 32px;
    border-bottom: 1px solid rgba(0,0,0,0.06);
    padding-bottom: 16px;
  }

  .page-header h2 {
    font-size: 32px;
    margin: 0;
    font-weight: 900;
  }
  @media (max-width: 1100px) {
    .magazine-row {
      grid-template-columns: 1fr;
    }

    .magazine-row.reverse {
      grid-template-columns: 1fr;
    }

    .magazine-small-grid {
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    .footer-inner {
      grid-template-columns: 1fr;
      gap: 32px;
    }
  }

  @media (max-width: 680px) {
    .home {
      margin-top: 80px;
    }

    .magazine-large {
      min-height: 400px;
    }

    .magazine-large .hero-title {
      font-size: 24px;
    }

    .card .thumb {
      height: 160px;
    }

    .mobile-large-post {
      margin-bottom: 24px;
    }

    .mobile-large-post .magazine-large {
      width: 100%;
      min-height: 350px;
    }

    .mobile-small-grid {
      margin-bottom: 32px;
    }

    .mobile-small-grid .magazine-small-grid {
      grid-template-columns: 1fr;
      gap: 12px;
    }

    .mobile-grid .card {
      margin-bottom: 0;
    }

    .mobile-grid .card .thumb {
      height: 180px;
    }

    .mobile-grid .card h3 {
      font-size: 15px;
      line-height: 1.4;
      margin-bottom: 8px;
    }

    .mobile-grid .card-body {
      padding: 14px;
    }

    .mobile-grid .card .meta {
      font-size: 12px;
    }

    .hero-title {
      font-size: 22px;
    }

    .card h3 {
      font-size: 14px;
    }

    .card-body {
      padding: 14px;
    }

    .theme-switch {
      width: 120px;
      height: 42px;
    }

    .theme-switch-slider {
      width: 54px;
      height: 34px;
    }

    body.dark-mode .theme-switch-slider {
      left: 62px;
    }

    .author-profile-section {
      flex-direction: column;
      text-align: center;
    }

    .post-to-top {
      bottom: 32px;
      right: 20px;
      width: 48px;
      height: 48px;
    }

    .to-top {
      display: none;
    }
  }

  @media (min-width: 1400px) {
    .magazine-row {
      gap: 28px;
    }

    .magazine-small-grid {
      gap: 24px;
    }
  }
  .copyright-notice {
    margin-top: 48px;
    color: #666;
    font-size: 14px;
    text-align: center;
    line-height: 1.8;
    padding: 20px;
    background: #f9f9f9;
    border-radius: 8px;
    border: 1px solid rgba(0,0,0,0.06);
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }
  body.dark-mode .copyright-notice {
    color: #cccccc;
    background: #1a1a1a;
    border-color: rgba(255,255,255,0.12);
  }
  </style>
</head>
<body>
  <div class="page-transition" id="pageTransition"></div>
  <div class="progress-bar" id="progressBar"></div>
  <header class="header" id="siteHeader">
    <div class="header-inner wrap">
      <div class="brand">
        <div class="logo" id="logoBtn" onclick="goToHome()">
          <img src="logo.png" alt="IMPACT logo" style="width:36px;height:36px;border-radius:8px;object-fit:cover;">
          <div class="logo-text">
            <div class="main-text">IMPACT</div>
            <small>MAKE A IMPACT</small>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn icon-btn" id="topSearchBtn" onclick="openNavlessSearch()">üîç</button>
        <button class="btn icon-btn" onclick="ui.toggleNav()">‚ò∞</button>
      </div>
    </div>
  </header>

  <div class="post-header-bar" id="postHeaderBar">
    <div class="header-inner wrap">
      <div class="brand">
        <div class="logo" onclick="goToHome()">
          <img src="logo.png" alt="IMPACT logo" style="width:36px;height:36px;border-radius:8px;object-fit:cover;">
          <div class="logo-text">
            <div class="main-text">IMPACT</div>
            <small>MAKE A IMPACT</small>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="btn icon-btn" onclick="handleNavToggle()">‚ò∞</button>
      </div>
    </div>
  </div>
  <aside class="nav-overlay" id="navOverlay">
    <button class="nav-close" onclick="ui.toggleNav(true)">‚úï</button>
    <div style="display:flex;flex-direction:column;gap:12px;">
      <div class="nav-search">
        <span style="font-size:18px">üîç</span>
        <input type="search" id="globalNavSearch" placeholder="Í≤ÄÏÉâÏñ¥ ÏûÖÎ†•">
      </div>
      <ul class="nav-list" id="navList"></ul>
      <div class="nav-footer-links">
        <a href="javascript:void(0)" onclick="handleNavAction(() => router.openAbout())">ABOUT</a>
        <a href="javascript:void(0)" onclick="handleNavAction(() => router.openEditors())">EDITORS</a>
        <a href="javascript:void(0)" onclick="ui.toggleNav(true); window.open('https://impactceo.art/newsletter', '_blank')">NEWSLETTER</a>
        <a href="https://www.instagram.com/ceo_impact_official" target="_blank" rel="noopener">INSTAGRAM</a>
      </div>
    </div>
  </aside>
  <main class="home" id="home">
    <div id="rowsContainer"></div>
    <div id="homeLoading" style="text-align:center;color:#666;padding:36px 0">Î°úÎî© Ï§ë...</div>
    <div class="pagination" id="homePagination"></div>
  </main>
  <section class="category-overlay" id="categoryOverlay">
    <div class="wrap">
      <div class="category-top">
        <div>
          <div class="category-title" id="categoryOverlayTitle">CATEGORY</div>
          <div class="category-sub" id="categoryOverlaySubtitle">Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ§Î™Ö</div>
        </div>
        <div>
          <button class="btn" onclick="router.closeCategory()">‚úï</button>
        </div>
      </div>
      <div class="category-grid" id="categoryGrid"></div>
      <div id="categoryLoading" style="text-align:center;color:#666;padding:28px 0"></div>
      <div class="pagination" id="categoryPagination"></div>
    </div>
  </section>
  <section class="editors-overlay" id="editorsOverlay">
    <div class="wrap">
      <div class="page-header">
        <div>
          <h2>EDITORS</h2>
          <div style="color:#666;font-size:14px;margin-top:8px">IMPACTÏóê Ï∞∏Ïó¨ÌïòÎäî ÏóêÎîîÌÑ∞ Î™©Î°ùÍ≥º Í∞Å ÏóêÎîîÌÑ∞Ïùò ÏûëÏÑ± Í∏ÄÏùÑ ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.</div>
        </div>
        <div>
          <button class="btn" onclick="router.closeEditors()">‚úï</button>
        </div>
      </div>
      <div id="editorsGridWrapper">
        <div id="editorsGrid" class="editors-grid"></div>
        <div id="editorsLoading" style="text-align:center;color:#666;padding:28px 0"></div>
      </div>
      <div id="editorProfileSection" style="display:none">
        <button class="btn" onclick="showEditorsList()" style="margin-bottom:20px">‚Üê ÏóêÎîîÌÑ∞ Î™©Î°ùÏúºÎ°ú</button>
        <h3 id="editorProfileName" style="font-size:28px;margin:0 0 12px"></h3>
        <p id="editorProfileBio" style="color:#666;margin-bottom:32px"></p>
        <div id="editorPostsGrid" class="category-grid"></div>
        <div id="editorPostsLoading" style="text-align:center;color:#666;padding:28px 0"></div>
      </div>
    </div>
  </section>
  <section class="search-overlay" id="searchOverlay">
    <div class="wrap" style="max-width:1200px">
      <div style="margin-bottom:32px">
        <div class="search-bar">
          <span style="font-size:20px">üîç</span>
          <input type="search" id="searchInput" placeholder="Í≤ÄÏÉâÏñ¥Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî" autofocus>
          <button class="close-btn" onclick="closeSearch()">‚úï</button>
        </div>
      </div>
      <div id="searchResults" class="category-grid"></div>
      <div id="searchLoading" style="text-align:center;color:#666;padding:28px 0"></div>
    </div>
  </section>
  <section class="about-page" id="aboutPage">
    <div class="wrap">
      <div class="page-header">
        <h2>ABOUT</h2>
        <button class="btn" onclick="router.closeAbout()">‚úï</button>
      </div>
      <div style="line-height:1.9;color:#444">
        <p style="font-size:22px;margin-bottom:16px;font-weight:700;color:#ff6b35">IMPACT MAGAZINE.</p>
        <p style="font-size:17px;margin-bottom:32px;font-weight:500;color:#333">ÏûÑÌå©Ìä∏ Îß§Í±∞ÏßÑÏùÄ ÏÇ¨ÌöåÏ†Å Ïù¥ÏäàÏôÄ Í∏∞Ïà† Î≥ÄÌôîÎ•º Î∂ÑÏÑùÌï¥ ÏùºÏÉÅÏùò Î¨∏Ï†úÎ•º Î∞úÍ≤¨ÌïòÍ≥† Í∑∏ Î≥∏ÏßàÏùÑ ÌÉêÍµ¨ÌïòÎäî ÌîåÎû´ÌèºÏûÖÎãàÎã§.</p>
        <p style="font-size:16px;margin-bottom:48px;color:#555">Ï≤≠ÎÖÑ Ï∞ΩÏóÖÍ∞Ä Ïù∏ÌÑ∞Î∑∞ÏôÄ ÏÇ¨ÌöåÌòÅÏã† ÏÇ¨Î°ÄÎ•º ÌÜµÌï¥ Î¨∏Ï†úÎ•º Í∏∞ÌöåÎ°ú Ï†ÑÌôòÌïòÎäî ÌÜµÏ∞∞ÏùÑ Ï†úÏãúÌïòÎäî <span style="background:linear-gradient(to top, #ff6b35 40%, transparent 40%);padding:2px 4px;font-weight:600">'Ïù¥Ïäà Í∏∞Î∞ò Ïù∏ÏÇ¨Ïù¥Ìä∏ Îß§Í±∞ÏßÑ'</span>ÏûÖÎãàÎã§.</p>

        <p style="margin-top:48px"><strong>made by KAIST IP-CEO</strong></p>

        <div style="margin-top:80px;margin-bottom:80px;border-top:1px solid #e0e0e0;padding-top:60px">
          <h3 style="font-size:20px;margin-bottom:8px;color:#333;font-weight:600">Our Journey</h3>
          <p style="font-size:14px;margin-bottom:48px;color:#999">2025-2029 ÏÑ±Ïû• Î°úÎìúÎßµ</p>

          <div style="position:relative">
            <div class="roadmap-timeline">
              <div class="roadmap-item" style="opacity:0;transform:translateX(-30px);animation:slideIn 0.6s ease forwards;animation-delay:0.2s">
                <div style="display:flex;align-items:center;margin-bottom:32px">
                  <div style="min-width:80px">
                    <span style="font-size:24px;font-weight:700;color:#ff6b35">2025</span>
                  </div>
                  <div style="flex:1;padding-left:24px;border-left:3px solid #ff6b35">
                    <h4 style="font-size:16px;font-weight:600;color:#333;margin-bottom:6px">Ïª§ÎÆ§ÎãàÌã∞ Í∏∞Î∞ò Íµ¨Ï∂ï</h4>
                    <p style="font-size:14px;color:#777;line-height:1.5">First Impact ‚Äî Î∏åÎûúÎìú Î≥¥Ïù¥Ïä§ ÌôïÎ¶Ω Î∞è Í≥µÏãù Ï±ÑÎÑê Îü∞Ïπ≠</p>
                  </div>
                </div>
              </div>

              <div class="roadmap-item" style="opacity:0;transform:translateX(-30px);animation:slideIn 0.6s ease forwards;animation-delay:0.4s">
                <div style="display:flex;align-items:center;margin-bottom:32px">
                  <div style="min-width:80px">
                    <span style="font-size:24px;font-weight:700;color:#888">2026</span>
                  </div>
                  <div style="flex:1;padding-left:24px;border-left:3px solid #ddd">
                    <h4 style="font-size:16px;font-weight:600;color:#333;margin-bottom:6px">ÏΩòÌÖêÏ∏† Ï∞∏Ïó¨ÎèÑ Ï¶ùÎåÄ</h4>
                    <p style="font-size:14px;color:#777;line-height:1.5">Second Impact ‚Äî Ï†ïÍ∏∞ Î©îÏùºÎßÅ ÏÑúÎπÑÏä§Î•º ÌÜµÌïú ÌÅêÎ†àÏù¥ÏÖò ÏΩòÌÖêÏ∏† Ï†ÑÎã¨</p>
                  </div>
                </div>
              </div>

              <div class="roadmap-item" style="opacity:0;transform:translateX(-30px);animation:slideIn 0.6s ease forwards;animation-delay:0.6s">
                <div style="display:flex;align-items:center;margin-bottom:32px">
                  <div style="min-width:80px">
                    <span style="font-size:24px;font-weight:700;color:#888">2027</span>
                  </div>
                  <div style="flex:1;padding-left:24px;border-left:3px solid #ddd">
                    <h4 style="font-size:16px;font-weight:600;color:#333;margin-bottom:6px">ÏÇ¨ÏóÖ ÌôïÏû• Í∏∞Î∞ò ÎßàÎ†®</h4>
                    <p style="font-size:14px;color:#777;line-height:1.5">Third Impact ‚Äî Ïò§ÌîºÏä§ Í∞úÏÜå Î∞è ÌîÑÎ°úÏ†ùÌä∏ ÌòëÏóÖ ÌóàÎ∏å Íµ¨Ï∂ï</p>
                  </div>
                </div>
              </div>

              <div class="roadmap-item" style="opacity:0;transform:translateX(-30px);animation:slideIn 0.6s ease forwards;animation-delay:0.8s">
                <div style="display:flex;align-items:center;margin-bottom:32px">
                  <div style="min-width:80px">
                    <span style="font-size:24px;font-weight:700;color:#888">2028</span>
                  </div>
                  <div style="flex:1;padding-left:24px;border-left:3px solid #ddd">
                    <h4 style="font-size:16px;font-weight:600;color:#333;margin-bottom:6px">Ïö¥ÏòÅ Ìö®Ïú® Í∑πÎåÄÌôî</h4>
                    <p style="font-size:14px;color:#777;line-height:1.5">Fourth Impact ‚Äî AI Í∏∞Î∞ò ÏΩòÌÖêÏ∏† Ï†úÏûë Î∞è Î∂ÑÏÑù ÏãúÏä§ÌÖú Íµ¨Ï∂ï</p>
                  </div>
                </div>
              </div>

              <div class="roadmap-item" style="opacity:0;transform:translateX(-30px);animation:slideIn 0.6s ease forwards;animation-delay:1s">
                <div style="display:flex;align-items:center;margin-bottom:32px">
                  <div style="min-width:80px">
                    <span style="font-size:24px;font-weight:700;color:#888">2029</span>
                  </div>
                  <div style="flex:1;padding-left:24px;border-left:3px solid #ddd">
                    <h4 style="font-size:16px;font-weight:600;color:#333;margin-bottom:6px">ÎØ∏ÏÖò ÌôïÏû•</h4>
                    <p style="font-size:14px;color:#777;line-height:1.5">Fifth Impact ‚Äî Factalk Îü∞Ïπ≠, Dream¬∑Design¬∑Do ÎØ∏ÏÖò ÌôïÏû•</p>
                  </div>
                </div>
              </div>
            </div>

            <p style="margin-top:32px;font-size:16px;color:#333;font-weight:700;padding:16px 20px;background:linear-gradient(to right, rgba(255,107,53,0.1), transparent);border-left:4px solid #ff6b35">
              ‚Üí <span style="background:linear-gradient(to top, #ff6b35 35%, transparent 35%);padding:2px 0">Í∏∞Ïà†Í≥º ÏÇ¨ÎûåÏùÑ Ïó∞Í≤∞ÌïòÎäî ÏßÄÏÜçÍ∞ÄÎä•Ìïú ÏòÅÌñ•Î†• Ï∞ΩÏ∂ú</span>
            </p>
          </div>
        </div>

        <h3 style="margin-top:48px;font-size:24px">IMPACT Í≥µÏãù Í≥ÑÏ†ï</h3>
        <p>Í¥ëÍ≥† Î¨∏Ïùò: <a href="mailto:welcome@impactceo.art" style="color:#ff6b35;font-weight:700">welcome@impactceo.art</a></p>
        <p>Îâ¥Ïä§Î†àÌÑ∞: <a href="mailto:press@impactceo.art" style="color:#ff6b35;font-weight:700">press@impactceo.art</a></p>
        <p>Í≥µÏãù Í≥ÑÏ†ï: <a href="mailto:ceo@impactceo.art" style="color:#ff6b35;font-weight:700">ceo@impactceo.art</a></p>
        <p>Instagram: <a href="https://www.instagram.com/ceo_impact_official" target="_blank" style="color:#ff6b35;font-weight:700">@ceo_impact_official</a></p>
      </div>
    </div>
  </section>

  <section class="post-overlay" id="postOverlay">
    <div class="post-article" id="postArticle">
    </div>
  </section>

  <div class="image-modal" id="imageModal">
    <button class="image-modal-close" onclick="closeImageModal()">‚úï</button>
    <img id="modalImage" src="" alt="ÌôïÎåÄ Ïù¥ÎØ∏ÏßÄ">
  </div>

  <button class="to-top" id="toTopBtn" onclick="scrollToTopButton()">‚Üë</button>
  <button class="post-to-top" id="postToTopBtn" onclick="scrollToTopButton()">‚Üë</button>

  <footer class="site-footer">
    <div class="wrap footer-inner">
      <div>
        <div class="footer-brand">IMPACT</div>
        <div style="margin-top:12px;color:#ddd;font-size:14px">Í¥ëÍ≥† Î¨∏Ïùò | <a href="mailto:welcome@impactceo.art">welcome@impactceo.art</a></div>
        <div style="color:#ddd;font-size:14px;margin-top:8px">Îâ¥Ïä§Î†àÌÑ∞ | <a href="mailto:press@impactceo.art">press@impactceo.art</a></div>
        <div style="color:#ddd;font-size:14px;margin-top:8px">Í≥µÏãù Í≥ÑÏ†ï | <a href="mailto:ceo@impactceo.art">ceo@impactceo.art</a></div>
      </div>
      <div class="footer-links">
        <a href="javascript:void(0)" onclick="router.openAbout()">ABOUT</a>
        <a href="javascript:void(0)" onclick="router.openEditors()">EDITORS</a>
        <a href="javascript:void(0)" onclick="window.open('https://impactceo.art/newsletter', '_blank')">NEWSLETTER</a>
        <a href="https://www.instagram.com/ceo_impact_official" target="_blank" rel="noopener">INSTAGRAM</a>
      </div>
      <div class="footer-right">
        <div style="font-weight:800;color:#fff;margin-bottom:16px">IMPACT CEO. ALL RIGHTS RESERVED.</div>
        <div class="theme-toggle">
          <div class="theme-toggle-label">THEME</div>
          <div class="theme-switch" onclick="toggleTheme()">
            <div class="theme-switch-text">
              <span class="light-text">LIGHT</span>
              <span class="dark-text">DARK</span>
            </div>
            <div class="theme-switch-slider"></div>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <template id="cardTpl">
    <article class="card">
      <div class="thumb"><img src="" alt=""></div>
      <div class="card-body">
        <div class="cat-row"></div>
        <h3 class="title"></h3>
        <div class="meta">
          <img class="author-avatar" src="" alt="" style="width:36px;height:36px;border-radius:50%;object-fit:cover;">
          <div>
            <div class="author-name"></div>
            <div class="date" style="font-size:12px;color:#777"></div>
          </div>
        </div>
      </div>
    </article>
  </template>
  <template id="editorTpl">
    <div class="editor-card">
      <img class="editor-avatar" src="" alt="">
      <div class="editor-name"></div>
      <div class="editor-bio"></div>
    </div>
  </template>
<script>
const WP_SITE = "impactceo0.wordpress.com";
const HOME_PER_PAGE = 20;
const CATEGORIES = {
  "tech": 318,
  "eat": 123073,
  "style": 2286,
  "culture": 1098,
  "life": 124,
  "editors-pick": 259543
};
const NAV_ORDER = ["TECH","EAT","STYLE","CULTURE","LIFE","EDITORS' PICK"];
const state = {
  homePage: 1,
  homeTotal: 0,
  categoryPage: 1,
  categoryTotal: 0,
  currentCategory: '',
  postsCache: {},
  editorsList: [],
  editorsLoaded: false,
  lastScrollY: 0,
  scrollingDown: false,
  currentPostId: null,
  isProcessing: false,
  searchDebounce: null,
  homeLoadPromise: null
};

function showPageTransition() {
  const transition = document.getElementById('pageTransition');
  transition.textContent = 'Î∂àÎü¨Ïò§Îäî Ï§ë...';
  transition.classList.add('active');
  return new Promise(resolve => {
    setTimeout(() => {
      transition.classList.remove('active');
      resolve();
    }, 300);
  });
}

function api(path) {
  const p = path.includes('_embed') ? path : (path + (path.includes('?') ? '&' : '?') + '_embed');
  return `/.netlify/functions/wpProxy?path=${encodeURIComponent(p)}`;
}
function formatDate(dstr) {
  try {
    const d = new Date(dstr);
    return `${d.getFullYear()}. ${String(d.getMonth()+1).padStart(2,'0')}. ${String(d.getDate()).padStart(2,'0')}.`;
  } catch(e) { return ''; }
}
function placeholderDataURI(w=600,h=400,txt='No Image') {
  const svg = `<svg xmlns='http://www.w3.org/2000/svg' width='${w}' height='${h}'><rect width='100%' height='100%' fill='#efefef'/><text x='50%' y='50%' fill='#aaa' font-size='20' text-anchor='middle' dominant-baseline='middle'>${txt}</text></svg>`;
  return 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(svg);
}
function pickCategoryClass(nameOrSlug) {
  if(!nameOrSlug) return '';
  const s = String(nameOrSlug).toLowerCase();
  if(s.includes('tech') || s.includes('technology')) return 'cat-tech';
  if(s.includes('eat')) return 'cat-eat';
  if(s.includes('style')) return 'cat-style';
  if(s.includes('culture')) return 'cat-culture';
  if(s.includes('life')) return 'cat-life';
  if(s.includes('editor') || s.includes('editors')) return 'cat-editors-pick';
  return '';
}
function stripTags(str='') {
  return str.replace(/<\/?[^>]+(>|$)/g, "");
}
function scrollToTop() {
  window.scrollTo({top: 0, behavior: 'smooth'});
}
function scrollToTopButton() {
  const postOverlay = document.getElementById('postOverlay');
  if(postOverlay.classList.contains('active')) {
    postOverlay.scrollTo({top: 0, behavior: 'smooth'});
  } else {
    window.scrollTo({top: 0, behavior: 'smooth'});
  }
}
function toggleTheme() {
  document.body.classList.toggle('dark-mode');
  const isDark = document.body.classList.contains('dark-mode');
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
}

function goToHome() {
  const logo = document.getElementById('logoBtn');
  logo.classList.add('clicked');
  setTimeout(() => {
    logo.classList.remove('clicked');
  }, 200);

  if(document.getElementById('postOverlay').classList.contains('active')) {
    router.closePost();
    return;
  }

  // Î∂àÎü¨Ïò§Í∏∞ Ï∞Ω ÏóÜÏù¥ Î∞îÎ°ú ÌéòÏù¥ÏßÄ Îã´Í≥† Ïä§ÌÅ¨Î°§
  document.querySelectorAll('.category-overlay, .search-overlay, .about-page, .editors-overlay').forEach(el => {
    el.classList.remove('active');
  });
  document.body.style.overflow = '';

  const newUrl = `${window.location.origin}${window.location.pathname}`;
  history.pushState({page:'home'}, '', newUrl);

  // Î∂ÄÎìúÎüΩÍ≤å ÏúÑÎ°ú Ïä§ÌÅ¨Î°§
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function handleNavToggle() {
  ui.toggleNav();
}
function handleNavAction(actionCallback) {
  ui.toggleNav(true);

  if(document.getElementById('postOverlay').classList.contains('active')) {
    const overlay = document.getElementById('postOverlay');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');
  }

  actionCallback();
}
if(localStorage.getItem('theme') === 'dark') {
  document.body.classList.add('dark-mode');
}
let ticking = false;
window.addEventListener('scroll', () => {
  if(!ticking) {
    window.requestAnimationFrame(() => {
      const toTop = document.getElementById('toTopBtn');
      if(window.scrollY > 300) toTop.classList.add('show');
      else toTop.classList.remove('show');

      const header = document.getElementById('siteHeader');
      const currentScrollY = window.scrollY;

      if(currentScrollY > state.lastScrollY && currentScrollY > 100) {
        header.classList.add('hide');
      } else {
        header.classList.remove('hide');
      }

      state.lastScrollY = currentScrollY;

      ticking = false;
    });
    ticking = true;
  }
});
document.getElementById('postOverlay').addEventListener('scroll', () => {
  if(!ticking) {
    window.requestAnimationFrame(() => {
      const progressBar = document.getElementById('progressBar');
      const postOverlay = document.getElementById('postOverlay');
      const postHeaderBar = document.getElementById('postHeaderBar');
      const postToTopBtn = document.getElementById('postToTopBtn');
      const winScroll = postOverlay.scrollTop;
      const height = postOverlay.scrollHeight - postOverlay.clientHeight;
      const scrolled = height > 0 ? (winScroll / height) * 100 : 0;
      progressBar.style.width = scrolled + '%';
      progressBar.classList.add('active');

      if(winScroll > 20) {
        postHeaderBar.classList.add('show');
      } else {
        postHeaderBar.classList.remove('show');
      }

      if(winScroll > 300) {
        postToTopBtn.classList.add('show');
      } else {
        postToTopBtn.classList.remove('show');
      }

      const thumbnail = document.querySelector('.post-thumbnail');
      if(thumbnail && winScroll > 100) {
        thumbnail.classList.add('scrolled');
      } else if(thumbnail) {
        thumbnail.classList.remove('scrolled');
      }

      ticking = false;
    });
    ticking = true;
  }
});
function renderNavList() {
  const navList = document.getElementById('navList');
  navList.innerHTML = '';
  NAV_ORDER.forEach(item => {
    const li = document.createElement('li');
    li.textContent = item;
    li.addEventListener('click', () => {
      const slug = item.toLowerCase().replace(/'/g,'').replace(/\s/g,'-');
      if(CATEGORIES[slug]) {
        handleNavAction(() => router.openCategory(slug));
      }
    });
    navList.appendChild(li);
  });
}
function createCardNode(post) {
  const tpl = document.getElementById('cardTpl');
  const node = tpl.content.firstElementChild.cloneNode(true);
  const imgEl = node.querySelector('.thumb img');
  let thumbUrl = '';
  try {
    thumbUrl = post._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
  } catch(e) { thumbUrl = ''; }
  imgEl.src = thumbUrl || placeholderDataURI(1200,800,'No Image');
  imgEl.alt = (post.title && post.title.rendered) ? stripTags(post.title.rendered) : 'thumb';
  node.querySelector('.title').innerHTML = post.title && post.title.rendered ? post.title.rendered : 'Ï†úÎ™© ÏóÜÏùå';
  const avatarImg = node.querySelector('.author-avatar');
  const authorNameEl = node.querySelector('.author-name');
  const dateEl = node.querySelector('.date');
  if(post._embedded && post._embedded.author && post._embedded.author[0]) {
    const a = post._embedded.author[0];
    const avatarUrl = a.avatar_urls ? (a.avatar_urls['48']||a.avatar_urls['24']||'') : '';
    avatarImg.src = avatarUrl || placeholderDataURI(96,96,'U');
    avatarImg.alt = a.name || 'author';
    authorNameEl.textContent = a.name || 'ÏùµÎ™Ö';
  } else {
    avatarImg.src = placeholderDataURI(96,96,'U');
    authorNameEl.textContent = 'ÏùµÎ™Ö';
  }
  dateEl.textContent = formatDate(post.date);
  const catRow = node.querySelector('.cat-row');
  catRow.innerHTML = '';
  if(post._embedded && post._embedded['wp:term'] && post._embedded['wp:term'][0]) {
    const cats = post._embedded['wp:term'][0];
    cats.forEach(c => {
      if(c && c.name) {
        const span = document.createElement('span');
        span.className = 'cat-badge';
        span.textContent = c.name;
        const cls = pickCategoryClass(c.slug || c.name);
        if(cls) span.classList.add(cls);
        else span.style.background = '#666';
        catRow.appendChild(span);
      }
    });
  }
  let clickTimeout;
  node.addEventListener('click', (e) => {
    e.preventDefault();
    e.stopPropagation();

    if(state.isProcessing) return;
    clearTimeout(clickTimeout);
    clickTimeout = setTimeout(() => {
      openPostOverlayById(post.id);
    }, 150);
  });

  return node;
}
function renderMobileLayout(posts, container) {
  for(let i = 0; i < posts.length; i += 5) {
    const group = posts.slice(i, i + 5);

    if(group[0]) {
      const largePost = group[0];
      const largeDiv = document.createElement('div');
      largeDiv.className = 'magazine-row mobile-large-post';

      const largeContainer = document.createElement('div');
      largeContainer.className = 'magazine-large';

      let heroUrl = largePost._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
      largeContainer.innerHTML = `
        <img class="hero" src="${heroUrl || placeholderDataURI(1200,800,'No Image')}" alt="hero">
        <div class="hero-overlay">
          <h2 class="hero-title">${largePost.title?.rendered || 'Ï†úÎ™© ÏóÜÏùå'}</h2>
          <div style="display:flex;align-items:center;gap:10px">
            <div class="hero-author" style="font-weight:800;color:#fff">${largePost._embedded?.author?.[0]?.name || 'ÏùµÎ™Ö'}</div>
            <div class="hero-date" style="color:#eee;opacity:.9">${formatDate(largePost.date)}</div>
          </div>
        </div>
      `;

      const catWrap = document.createElement('div');
      catWrap.className = 'hero-cats';
      const firstCat = largePost._embedded?.['wp:term']?.[0]?.[0];
      if(firstCat) {
        const span = document.createElement('span');
        span.className = 'cat-badge ' + pickCategoryClass(firstCat.slug || firstCat.name);
        span.textContent = firstCat.name;
        catWrap.appendChild(span);
      }
      largeContainer.appendChild(catWrap);

      let clickTimeout;
      largeContainer.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();

        if(state.isProcessing) return;
        clearTimeout(clickTimeout);
        clickTimeout = setTimeout(() => {
          openPostOverlayById(largePost.id);
        }, 150);
      });

      largeDiv.appendChild(largeContainer);
      container.appendChild(largeDiv);
    }

    const smallPosts = group.slice(1, 5);
    if(smallPosts.length > 0) {
      const smallDiv = document.createElement('div');
      smallDiv.className = 'magazine-row mobile-small-grid';

      const smallGrid = document.createElement('div');
      smallGrid.className = 'magazine-small-grid mobile-grid';

      smallPosts.forEach(post => {
        if(post) {
          const card = createCardNode(post);
          smallGrid.appendChild(card);
        }
      });

      smallDiv.appendChild(smallGrid);
      container.appendChild(smallDiv);
    }
  }
}
function renderDesktopLayout(posts, container) {
  for(let i = 0; i < posts.length; i += 5) {
    const group = posts.slice(i, i + 5);
    const row = document.createElement('div');
    row.className = 'magazine-row';

    const isEven = Math.floor(i / 5) % 2 === 0;
    if(!isEven) {
      row.classList.add('reverse');
    }
    if(group[0]) {
      const largePost = group[0];
      const largeDiv = document.createElement('div');
      largeDiv.className = 'magazine-large';

      let heroUrl = largePost._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
      largeDiv.innerHTML = `
        <img class="hero" src="${heroUrl || placeholderDataURI(1200,800,'No Image')}" alt="hero">
        <div class="hero-overlay">
          <h2 class="hero-title">${largePost.title?.rendered || 'Ï†úÎ™© ÏóÜÏùå'}</h2>
          <div style="display:flex;align-items:center;gap:10px">
            <div class="hero-author" style="font-weight:800;color:#fff">${largePost._embedded?.author?.[0]?.name || 'ÏùµÎ™Ö'}</div>
            <div class="hero-date" style="color:#eee;opacity:.9">${formatDate(largePost.date)}</div>
          </div>
        </div>
      `;

      const catWrap = document.createElement('div');
      catWrap.className = 'hero-cats';
      const firstCat = largePost._embedded?.['wp:term']?.[0]?.[0];
      if(firstCat) {
        const span = document.createElement('span');
        span.className = 'cat-badge ' + pickCategoryClass(firstCat.slug || firstCat.name);
        span.textContent = firstCat.name;
        catWrap.appendChild(span);
      }
      largeDiv.appendChild(catWrap);

      let clickTimeout;
      largeDiv.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();

        if(state.isProcessing) return;
        clearTimeout(clickTimeout);
        clickTimeout = setTimeout(() => {
          openPostOverlayById(largePost.id);
        }, 150);
      });

      if(isEven) {
        row.appendChild(largeDiv);
      }
    }
    const smallGrid = document.createElement('div');
    smallGrid.className = 'magazine-small-grid';
    group.slice(1, 5).forEach(post => {
      if(post) {
        const card = createCardNode(post);
        smallGrid.appendChild(card);
      }
    });

    if(isEven) {
      row.appendChild(smallGrid);
    } else {
      row.appendChild(smallGrid);
      if(group[0]) {
        const largePost = group[0];
        const largeDiv = document.createElement('div');
        largeDiv.className = 'magazine-large';

        let heroUrl = largePost._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
        largeDiv.innerHTML = `
          <img class="hero" src="${heroUrl || placeholderDataURI(1200,800,'No Image')}" alt="hero">
          <div class="hero-overlay">
            <h2 class="hero-title">${largePost.title?.rendered || 'Ï†úÎ™© ÏóÜÏùå'}</h2>
            <div style="display:flex;align-items:center;gap:10px">
              <div class="hero-author" style="font-weight:800;color:#fff">${largePost._embedded?.author?.[0]?.name || 'ÏùµÎ™Ö'}</div>
              <div class="hero-date" style="color:#eee;opacity:.9">${formatDate(largePost.date)}</div>
            </div>
          </div>
        `;

        const catWrap = document.createElement('div');
        catWrap.className = 'hero-cats';
        const firstCat = largePost._embedded?.['wp:term']?.[0]?.[0];
        if(firstCat) {
          const span = document.createElement('span');
          span.className = 'cat-badge ' + pickCategoryClass(firstCat.slug || firstCat.name);
          span.textContent = firstCat.name;
          catWrap.appendChild(span);
        }
        largeDiv.appendChild(catWrap);

        let clickTimeout;
        largeDiv.addEventListener('click', (e) => {
          e.preventDefault();
          e.stopPropagation();

          if(state.isProcessing) return;
          clearTimeout(clickTimeout);
          clickTimeout = setTimeout(() => {
            openPostOverlayById(largePost.id);
          }, 150);
        });

        row.appendChild(largeDiv);
      }
    }
    container.appendChild(row);
  }
}
async function loadHomeChunk(page = 1) {
  if(state.isProcessing || state.homeLoadPromise) return state.homeLoadPromise;

  state.isProcessing = true;

  const loadingEl = document.getElementById('homeLoading');
  loadingEl.textContent = 'Î°úÎî© Ï§ë...';
  state.homeLoadPromise = new Promise(async (resolve, reject) => {
    try {
      const res = await fetch(api(`posts?per_page=${HOME_PER_PAGE}&page=${page}`));
      if(!res.ok) throw new Error('Failed to load');

      const totalPages = parseInt(res.headers.get('X-WP-TotalPages') || '1');
      state.homeTotal = totalPages;

      const posts = await res.json();
      if(!Array.isArray(posts) || posts.length === 0) {
        loadingEl.textContent = 'Í≤åÏãúÎ¨ºÏù¥ ÏóÜÏäµÎãàÎã§.';
        state.isProcessing = false;
        state.homeLoadPromise = null;
        resolve();
        return;
      }
      const uniquePosts = posts.filter((post, index, self) =>
        index === self.findIndex(p => p.id === post.id)
      );

      uniquePosts.forEach(p => state.postsCache[p.id] = p);
      const container = document.getElementById('rowsContainer');

      if(page === 1) {
        container.innerHTML = '';
      }
      const isMobile = window.innerWidth <= 680;
      if(isMobile) {
        renderMobileLayout(uniquePosts, container);
      } else {
        renderDesktopLayout(uniquePosts, container);
      }
      renderPagination('homePagination', page, totalPages, (p) => {
        state.homePage = p;
        state.homeLoadPromise = null;
        showPageTransition().then(() => {
          loadHomeChunk(p);
          scrollToTop();
        });
      });
      loadingEl.textContent = '';
      resolve();
    } catch(err) {
      console.error(err);
      loadingEl.textContent = 'Î°úÎî© Ïã§Ìå®. ÏÉàÎ°úÍ≥†Ïπ®ÏùÑ ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
      reject(err);
    } finally {
      state.isProcessing = false;
      state.homeLoadPromise = null;
    }
  });

  return state.homeLoadPromise;
}
function renderPagination(containerId, currentPage, totalPages, onPageClick) {
  const container = document.getElementById(containerId);
  if(!container) return;

  container.innerHTML = '';

  if(totalPages <= 1) return;

  const prevBtn = document.createElement('button');
  prevBtn.textContent = '‚Äπ';
  prevBtn.disabled = currentPage === 1;
  prevBtn.onclick = () => onPageClick(currentPage - 1);
  container.appendChild(prevBtn);

  const startPage = Math.max(1, currentPage - 2);
  const endPage = Math.min(totalPages, currentPage + 2);

  if(startPage > 1) {
    const firstBtn = document.createElement('button');
    firstBtn.textContent = '1';
    firstBtn.onclick = () => onPageClick(1);
    container.appendChild(firstBtn);

    if(startPage > 2) {
      const dots = document.createElement('span');
      dots.textContent = '‚Ä¢‚Ä¢‚Ä¢';
      dots.style.padding = '0 8px';
      container.appendChild(dots);
    }
  }

  for(let i = startPage; i <= endPage; i++) {
    const btn = document.createElement('button');
    btn.textContent = i;
    if(i === currentPage) btn.classList.add('active');
    btn.onclick = () => onPageClick(i);
    container.appendChild(btn);
  }

  if(endPage < totalPages) {
    if(endPage < totalPages - 1) {
      const dots = document.createElement('span');
      dots.textContent = '‚Ä¢‚Ä¢‚Ä¢';
      dots.style.padding = '0 8px';
      container.appendChild(dots);
    }

    const lastBtn = document.createElement('button');
    lastBtn.textContent = totalPages;
    lastBtn.onclick = () => onPageClick(totalPages);
    container.appendChild(lastBtn);
  }

  const nextBtn = document.createElement('button');
  nextBtn.textContent = '‚Ä∫';
  nextBtn.disabled = currentPage === totalPages;
  nextBtn.onclick = () => onPageClick(currentPage + 1);
  container.appendChild(nextBtn);
}
async function loadCategory(slug, page = 1) {
  if(state.isProcessing) return;
  state.isProcessing = true;

  await showPageTransition();

  state.currentCategory = slug;
  state.categoryPage = page;

  const overlay = document.getElementById('categoryOverlay');
  
  // Ïò§Î≤ÑÎ†àÏù¥Î•º ÌôúÏÑ±ÌôîÌïòÍ∏∞ Ï†ÑÏóê Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏúÑÎ°ú
  overlay.scrollTop = 0;
  overlay.classList.add('active');

  if(window.innerWidth <= 680) {
    document.body.style.overflow = 'hidden';
  }

  document.getElementById('categoryOverlayTitle').textContent = slug.toUpperCase();

  const newUrl = `${window.location.origin}${window.location.pathname}?category=${slug}`;
  history.pushState({page:'category', slug:slug}, '', newUrl);

  const descriptions = {
    'tech': 'Í∏∞Ïà†Í≥º ÌòÅÏã†Ïóê ÎåÄÌïú Ïã¨Ï∏µ Î∂ÑÏÑù',
    'eat': 'ÏùåÏãùÍ≥º Ïô∏Ïãù Î¨∏Ìôî ÌÉêÍµ¨',
    'style': 'Ìå®ÏÖòÍ≥º ÎùºÏù¥ÌîÑÏä§ÌÉÄÏùº Ìä∏Î†åÎìú',
    'culture': 'Î¨∏ÌôîÏôÄ ÏòàÏà†Ïóê ÎåÄÌïú Ïù∏ÏÇ¨Ïù¥Ìä∏',
    'life': 'ÏùºÏÉÅÍ≥º ÏÇ∂Ïóê ÎåÄÌïú Ïù¥ÏïºÍ∏∞',
    'editors-pick': 'ÏóêÎîîÌÑ∞Í∞Ä ÏÑ†Ï†ïÌïú Ï∂îÏ≤ú ÏΩòÌÖêÏ∏†'
  };
  document.getElementById('categoryOverlaySubtitle').textContent = descriptions[slug] || 'Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÑ§Î™Ö';

  const grid = document.getElementById('categoryGrid');
  grid.innerHTML = '';
  document.getElementById('categoryLoading').textContent = 'Î°úÎî© Ï§ë...';
  try {
    const catId = CATEGORIES[slug];
    if(!catId) {
      document.getElementById('categoryLoading').textContent = 'Ïïå Ïàò ÏóÜÎäî Ïπ¥ÌÖåÍ≥†Î¶¨ÏûÖÎãàÎã§.';
      state.isProcessing = false;
      return;
    }

    const res = await fetch(api(`posts?categories=${catId}&per_page=20&page=${page}`));
    if(!res.ok) throw new Error('Failed');

    const totalPages = parseInt(res.headers.get('X-WP-TotalPages') || '1');
    state.categoryTotal = totalPages;

    const posts = await res.json();
    if(Array.isArray(posts)) {
      const uniquePosts = posts.filter((post, index, self) =>
        index === self.findIndex(p => p.id === post.id)
      );

      uniquePosts.forEach(p => {
        state.postsCache[p.id] = p;
        const card = createCardNode(p);
        grid.appendChild(card);
      });
    }

    renderPagination('categoryPagination', page, totalPages, (p) => {
      showPageTransition().then(() => {
        loadCategory(slug, p);
      });
    });

    document.getElementById('categoryLoading').textContent = '';
  } catch(e) {
    console.error(e);
    document.getElementById('categoryLoading').textContent = 'Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®';
  }

  state.isProcessing = false;
}
async function loadEditors() {
  if(state.editorsLoaded) return;
  document.getElementById('editorsLoading').textContent = 'Î°úÎî© Ï§ë...';
  try {
    const res = await fetch(api(`users?per_page=100`));
    if(!res.ok) throw new Error('editors api fail ' + res.status);
    const users = await res.json();
    state.editorsList = Array.isArray(users) ? users : [];
    renderEditorsGrid();
    state.editorsLoaded = true;
    document.getElementById('editorsLoading').textContent = '';
  } catch(e) {
    console.error(e);
    document.getElementById('editorsLoading').textContent = 'ÏóêÎîîÌÑ∞ Î™©Î°ùÏùÑ Î∂àÎü¨Ïò§ÏßÄ Î™ªÌñàÏäµÎãàÎã§.';
  }
}
function renderEditorsGrid() {
  const wrap = document.getElementById('editorsGrid');
  wrap.innerHTML = '';
  const tpl = document.getElementById('editorTpl');
  state.editorsList.forEach(u => {
    const node = tpl.content.firstElementChild.cloneNode(true);
    const img = node.querySelector('.editor-avatar');
    img.src = (u.avatar_urls && (u.avatar_urls['96']||u.avatar_urls['48']||u.avatar_urls['24'])) ? (u.avatar_urls['96']||u.avatar_urls['48']||u.avatar_urls['24']) : placeholderDataURI(96,96,'U');
    img.alt = u.name || u.slug || 'editor';
    node.querySelector('.editor-name').textContent = u.name || u.slug || 'unknown';
    node.querySelector('.editor-bio').textContent = u.description || '';
    node.addEventListener('click', () => router.openEditorProfile(u));
    wrap.appendChild(node);
  });
}
function showEditorsList() {
  document.getElementById('editorProfileSection').style.display = 'none';
  document.getElementById('editorsGridWrapper').style.display = 'block';
  history.pushState({page:'editors'}, '', '#editors');
}
async function loadRelatedPosts(categories, currentPostId) {
  if(!categories || categories.length === 0) return [];

  try {
    const catId = categories[0].id;
    const res = await fetch(api(`posts?categories=${catId}&per_page=8&exclude=${currentPostId}`));
    if(!res.ok) return [];
    const posts = await res.json();

    const uniquePosts = Array.isArray(posts)
      ? posts.filter((p, index, self) =>
          p.id !== currentPostId && index === self.findIndex(post => post.id === p.id)
        ).slice(0, 4)
      : [];

    return uniquePosts;
  } catch(e) {
    console.error(e);
    return [];
  }
}

function openImageModal(imgSrc) {
  const modal = document.getElementById('imageModal');
  const modalImg = document.getElementById('modalImage');
  modalImg.src = imgSrc;
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
}

function closeImageModal() {
  const modal = document.getElementById('imageModal');
  modal.classList.remove('active');
  if(!document.getElementById('postOverlay').classList.contains('active')) {
    document.body.style.overflow = '';
  }
}

async function openPostOverlayById(id, updateURL = true) {
  if(!id || state.isProcessing) return;
  state.isProcessing = true;

  await showPageTransition();

  state.currentPostId = id;

  if(updateURL) {
    const currentUrl = window.location.href;
    const currentParams = new URLSearchParams(window.location.search);
    const currentCategory = currentParams.get('category');
    const currentEditor = currentParams.get('editor');
    const currentPage = currentParams.get('page');

    let previousState = {
      url: currentUrl,
      page: 'home',
      scrollPosition: window.scrollY
    };

    if(currentCategory) {
      previousState.page = 'category';
      previousState.category = currentCategory;
    } else if(currentEditor) {
      previousState.page = 'editor';
      previousState.editor = currentEditor;
    } else if(currentPage === 'search') {
      previousState.page = 'search';
      previousState.searchTerm = document.getElementById('searchInput')?.value || '';
    } else if(currentPage === 'about') {
      previousState.page = 'about';
    } else if(currentPage === 'editors') {
      previousState.page = 'editors';
    }

    const newUrl = `${window.location.origin}${window.location.pathname}?post=${id}`;
    history.pushState({page: 'post', id: id, previous: previousState}, '', newUrl);
  }

  const overlay = document.getElementById('postOverlay');
  const article = document.getElementById('postArticle');

  // Ïò§Î≤ÑÎ†àÏù¥Î•º ÌôúÏÑ±ÌôîÌïòÍ∏∞ Ï†ÑÏóê Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏúÑÎ°ú
  overlay.scrollTop = 0;
  overlay.classList.add('active');
  document.body.style.overflow = 'hidden';

  const cached = state.postsCache[id];
  if(cached && cached.content && cached.content.rendered) {
    await renderPostOverlay(cached);
    state.isProcessing = false;
    return;
  }

  article.innerHTML = `
    <div class="post-loading-container" style="
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 60vh;
      flex-direction: column;
      gap: 16px;
    ">
      <div class="spinner" style="
        width: 40px;
        height: 40px;
        border: 3px solid #f3f3f3;
        border-top: 3px solid #ff6b35;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      "></div>
      <p style="color: #666; font-size: 16px;">Í≤åÏãúÎ¨ºÏùÑ Î∂àÎü¨Ïò§Îäî Ï§ë...</p>
    </div>
  `;

  try {
    const res = await fetch(api(`posts/${id}?_embed`));
    if(!res.ok) throw new Error('post fetch failed ' + res.status);
    const post = await res.json();

    state.postsCache[id] = post;

    await renderPostOverlay(post);
  } catch(e) {
    console.error(e);
    article.innerHTML = `
      <div class="post-error-container" style="
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 60vh;
        flex-direction: column;
        gap: 16px;
      ">
        <p style="color: #e74c3c; font-size: 18px;">Í≤åÏãúÎ¨ºÏùÑ Î∂àÎü¨Ïò¨ Ïàò ÏóÜÏäµÎãàÎã§.</p>
        <button onclick="router.closePost()" class="btn" style="padding: 8px 16px;">ÎèåÏïÑÍ∞ÄÍ∏∞</button>
      </div>
    `;
  }

  state.isProcessing = false;
}
async function renderPostOverlay(post) {
  const overlay = document.getElementById('postOverlay');
  const article = document.getElementById('postArticle');
  const title = post.title && post.title.rendered ? post.title.rendered : 'Ï†úÎ™© ÏóÜÏùå';
  const authorName = (post._embedded && post._embedded.author && post._embedded.author[0] && post._embedded.author[0].name) ? post._embedded.author[0].name : 'ÏùµÎ™Ö';
  const authorData = post._embedded?.author?.[0] || {};
  const avatar = (post._embedded && post._embedded.author && post._embedded.author[0] && post._embedded.author[0].avatar_urls) ? (post._embedded.author[0].avatar_urls['96'] || post._embedded.author[0].avatar_urls['48']) : '';
  const categories = (post._embedded && post._embedded['wp:term'] && post._embedded['wp:term'][0]) ? post._embedded['wp:term'][0].map(t=>t.name).join(', ') : '-';
  const dateStr = formatDate(post.date);
  const contentHTML = post.content && post.content.rendered ? post.content.rendered : (post.excerpt && post.excerpt.rendered ? post.excerpt.rendered : '');
  const featuredUrl = post._embedded?.['wp:featuredmedia']?.[0]?.source_url || '';
  article.innerHTML = `
    <div class="post-hero-section">
      <div class="post-header">
        ${featuredUrl ? `
          <div class="post-thumbnail-container">
            <div class="post-thumbnail">
              <img src="${featuredUrl}" alt="featured image">
            </div>
          </div>
        ` : ''}
        <div class="post-info-container">
          <div class="post-info">
            <div class="cat-row" style="margin-bottom:16px">
              ${post._embedded?.['wp:term']?.[0]?.map(c => {
                const cls = pickCategoryClass(c.slug || c.name);
                return `<span class="cat-badge ${cls}">${c.name}</span>`;
              }).join('') || ''}
            </div>
            <h1>${title}</h1>
            <div class="post-meta-info">
              <div class="meta-row">
                <img src="${avatar || placeholderDataURI(96,96,'U')}" alt="author" class="author-avatar">
                <strong>${authorName}</strong>
              </div>
              <div class="meta-row">
                <span>üìÖ ${dateStr}</span>
              </div>
              <div class="meta-row">
                <span>üè∑Ô∏è ${categories}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="post-content">${contentHTML}</div>
    <div class="author-profile-section" style="cursor: pointer;" onclick="event.preventDefault(); event.stopPropagation(); (() => { const overlay = document.getElementById('postOverlay'); overlay.classList.remove('active'); document.body.style.overflow = ''; document.getElementById('progressBar').classList.remove('active'); document.getElementById('postHeaderBar').classList.remove('show'); document.getElementById('postToTopBtn').classList.remove('show'); router.openEditorProfile({id: ${authorData.id}, name: '${authorName}', description: '${(authorData.description || '').replace(/'/g, "\\'")}', avatar_urls: ${JSON.stringify(authorData.avatar_urls || {})}, slug: '${authorData.slug || ''}'}, true); })()">
      <img src="${avatar || placeholderDataURI(96,96,'U')}" alt="${authorName}" class="author-profile-avatar">
      <div class="author-profile-info">
        <div class="author-profile-name">${authorName}</div>
        <div class="author-profile-bio">${authorData.description || 'ÏóêÎîîÌÑ∞ ÏÜåÍ∞úÍ∞Ä ÏóÜÏäµÎãàÎã§.'}</div>
      </div>
    </div>
    <div class="copyright-notice">
      Î≥∏ ÏΩòÌÖêÏ∏†Ïùò Î™®Îì† Ï†ÄÏûëÍ∂å Î∞è ÏßÄÏãùÏû¨ÏÇ∞Í∂åÏùÄ IMPACTÏóê Í∑ÄÏÜçÎê©ÎãàÎã§. Î¨¥Îã® Î≥µÏ†ú, Ï†ÑÏû¨ Îì± 2Ï∞®Ï†Å Ï†ÄÏûëÎ¨º ÏÉùÏÑ± Îì± ÏùºÏ≤¥Ïùò Î¨¥Îã® Ïù¥Ïö©ÏùÑ Í∏àÌï©ÎãàÎã§. Ïù¥Î•º ÏúÑÎ∞òÌï† Í≤ΩÏö∞, ÎØºÌòïÏÇ¨ÏÉÅ Í∞ïÎ†•Ìïú Î≤ïÏ†Å Ï°∞ÏπòÍ∞Ä Ï∑®Ìï¥Ïßà Ïàò ÏûàÏäµÎãàÎã§.
    </div>
    <div id="relatedPostsContainer"></div>
  `;
  
  article.querySelectorAll('.post-content img').forEach(img=>{
    img.style.maxWidth = '100%';
    img.style.height = 'auto';
    img.style.display = 'block';
    img.style.margin = '12px 0';
    img.style.cursor = 'pointer';
    img.style.pointerEvents = 'auto';
    
    img.addEventListener('click', (e) => {
      e.preventDefault();
      e.stopPropagation();
      openImageModal(img.src);
    });
  });

  try {
    const allNodes = Array.from(article.querySelectorAll('.post-content *'));
    allNodes.forEach(el => {
      if (el && el.textContent && el.textContent.trim().includes('Ïù¥ Í∏Ä Í≥µÏú†ÌïòÍ∏∞')) {
        el.remove();
      }
    });
  } catch(e) { }
  try {
    article.querySelectorAll('.updated, time[itemprop="dateModified"], [data-modified], .post-modified, .modified-date').forEach(el => el.remove());
  } catch(e) { }
  const postCategories = post._embedded?.['wp:term']?.[0] || [];
  if(postCategories.length > 0) {
    const relatedPosts = await loadRelatedPosts(postCategories, post.id);
    if(relatedPosts.length > 0) {
      const relatedContainer = document.getElementById('relatedPostsContainer');
      const relatedSection = document.createElement('div');
      relatedSection.className = 'related-posts';
      relatedSection.innerHTML = '<h3>Í∞ôÏùÄ Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Îã§Î•∏ Í∏Ä</h3><div class="related-grid" id="relatedGrid"></div>';
      relatedContainer.appendChild(relatedSection);

      const relatedGrid = document.getElementById('relatedGrid');
      relatedPosts.forEach(p => {
        state.postsCache[p.id] = p;
        const card = createCardNode(p);
        relatedGrid.appendChild(card);
      });
    }
  }
  overlay.classList.add('active');
  overlay.scrollTop = 0;
  document.body.style.overflow = 'hidden';

  const progressBar = document.getElementById('progressBar');
  progressBar.classList.add('active');
  progressBar.style.width = '0%';
}
const ui = {
  toggleNav: (forceClose = false) => {
    const nav = document.getElementById('navOverlay');
    if(forceClose) {
      nav.classList.remove('active');
      if(window.innerWidth <= 680) {
        document.body.style.overflow = '';
      }
    } else {
      nav.classList.toggle('active');
      if(window.innerWidth <= 680) {
        if(nav.classList.contains('active')) {
          document.body.style.overflow = 'hidden';
        } else {
          document.body.style.overflow = '';
        }
      }
    }
  }
};
const router = {
  openCategory: (slug, updateURL = true) => {
    loadCategory(slug, 1);
    if(updateURL) {
      const newUrl = `${window.location.origin}${window.location.pathname}?category=${slug}`;
      history.pushState({page:'category', slug:slug}, '', newUrl);
    }
  },
  closeCategory: () => {
    showPageTransition().then(async () => {
      document.getElementById('categoryOverlay').classList.remove('active');
      document.body.style.overflow = '';
      const newUrl = `${window.location.origin}${window.location.pathname}`;
      history.pushState({page:'home'}, '', newUrl);
      
      // Î©îÏù∏ ÌôàÏù¥ Î°úÎìúÎêòÏßÄ ÏïäÏïòÎã§Î©¥ Îã§Ïãú Î°úÎìú
      if(state.homePosts.length === 0) {
        await loadHomeChunk(1);
      }
    });
  },
  openEditors: async (updateURL = true) => {
    await showPageTransition();
    document.getElementById('editorsOverlay').classList.add('active');
    document.getElementById('editorsOverlay').scrollTop = 0;
    if(window.innerWidth <= 680) {
      document.body.style.overflow = 'hidden';
    }
    loadEditors();
    if(updateURL) {
      const newUrl = `${window.location.origin}${window.location.pathname}?page=editors`;
      history.pushState({page:'editors'}, '', newUrl);
    }
  },
  closeEditors: () => {
    showPageTransition().then(async () => {
      document.getElementById('editorsOverlay').classList.remove('active');
      document.body.style.overflow = '';
      const newUrl = `${window.location.origin}${window.location.pathname}`;
      history.pushState({page:'home'}, '', newUrl);
      
      // Î©îÏù∏ ÌôàÏù¥ Î°úÎìúÎêòÏßÄ ÏïäÏïòÎã§Î©¥ Îã§Ïãú Î°úÎìú
      if(state.homePosts.length === 0) {
        await loadHomeChunk(1);
      }
    });
  },
  openAbout: async (updateURL = true) => {
    await showPageTransition();
    document.getElementById('aboutPage').classList.add('active');
    document.getElementById('aboutPage').scrollTop = 0;
    if(window.innerWidth <= 680) {
      document.body.style.overflow = 'hidden';
    }
    if(updateURL) {
      const newUrl = `${window.location.origin}${window.location.pathname}?page=about`;
      history.pushState({page:'about'}, '', newUrl);
    }
  },
  closeAbout: () => {
    showPageTransition().then(async () => {
      document.getElementById('aboutPage').classList.remove('active');
      document.body.style.overflow = '';
      const newUrl = `${window.location.origin}${window.location.pathname}`;
      history.pushState({page:'home'}, '', newUrl);
      
      // Î©îÏù∏ ÌôàÏù¥ Î°úÎìúÎêòÏßÄ ÏïäÏïòÎã§Î©¥ Îã§Ïãú Î°úÎìú
      if(state.homePosts.length === 0) {
        await loadHomeChunk(1);
      }
    });
  },
  closePost: () => {
    const overlay = document.getElementById('postOverlay');
    overlay.classList.remove('active');
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');

    const currentState = history.state;
    if(currentState && currentState.previous) {
      const prev = currentState.previous;

      if(prev.page === 'category' && prev.category) {
        const newUrl = `${window.location.origin}${window.location.pathname}?category=${prev.category}`;
        history.pushState({page: 'category', slug: prev.category}, '', newUrl);
        router.openCategory(prev.category, false);
      } else if(prev.page === 'editor' && prev.editor) {
        const newUrl = `${window.location.origin}${window.location.pathname}?editor=${prev.editor}`;
        history.pushState({page: 'editor', id: prev.editor}, '', newUrl);
        router.openEditors(false);
        setTimeout(async () => {
          if(state.editorsList.length === 0) {
            await loadEditors();
          }
          const editor = state.editorsList.find(e => e.id === parseInt(prev.editor));
          if(editor) {
            router.openEditorProfile(editor, false);
          }
        }, 100);
      } else if(prev.page === 'search') {
        const newUrl = `${window.location.origin}${window.location.pathname}?page=search`;
        history.pushState({page: 'search'}, '', newUrl);
        openNavlessSearch(false);
        if(prev.searchTerm) {
          setTimeout(() => {
            const searchInput = document.getElementById('searchInput');
            if(searchInput) {
              searchInput.value = prev.searchTerm;
              performSearch(prev.searchTerm, 'fullSearch');
            }
          }, 100);
        }
      } else if(prev.page === 'about') {
        const newUrl = `${window.location.origin}${window.location.pathname}?page=about`;
        history.pushState({page: 'about'}, '', newUrl);
        router.openAbout(false);
      } else if(prev.page === 'editors') {
        const newUrl = `${window.location.origin}${window.location.pathname}?page=editors`;
        history.pushState({page: 'editors'}, '', newUrl);
        router.openEditors(false);
      } else {
        const newUrl = `${window.location.origin}${window.location.pathname}`;
        history.pushState({page: 'home'}, '', newUrl);
        
        // Î©îÏù∏ ÌôàÏù¥ Î°úÎìúÎêòÏßÄ ÏïäÏïòÎã§Î©¥ Îã§Ïãú Î°úÎìú
        if(state.homePosts.length === 0) {
          loadHomeChunk(1).then(() => {
            if(prev.scrollPosition) {
              setTimeout(() => {
                window.scrollTo(0, prev.scrollPosition);
              }, 100);
            }
          });
        } else if(prev.scrollPosition) {
          setTimeout(() => {
            window.scrollTo(0, prev.scrollPosition);
          }, 100);
        }
      }
    } else {
      history.back();
    }
  },
  openEditorProfile: async (user, updateURL = true) => {
    if(!user || !user.id) return;
    
    await showPageTransition();
    
    const overlay = document.getElementById('editorsOverlay');
    
    // Ïò§Î≤ÑÎ†àÏù¥Î•º ÌôúÏÑ±ÌôîÌïòÍ∏∞ Ï†ÑÏóê Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏúÑÎ°ú
    overlay.scrollTop = 0;
    
    if(!overlay.classList.contains('active')) {
      overlay.classList.add('active');
      if(window.innerWidth <= 680) {
        document.body.style.overflow = 'hidden';
      }
    }
    
    document.getElementById('editorsGridWrapper').style.display = 'none';
    const section = document.getElementById('editorProfileSection');
    section.style.display = 'block';
    document.getElementById('editorProfileName').textContent = user.name || user.slug || '';
    document.getElementById('editorProfileBio').textContent = user.description || '';
    const grid = document.getElementById('editorPostsGrid');
    grid.innerHTML = '';
    document.getElementById('editorPostsLoading').textContent = 'Î°úÎî© Ï§ë...';
    
    if(state.editorsList.length === 0) {
      await loadEditors();
    }
    
    try {
      const res = await fetch(api(`posts?author=${user.id}&per_page=50`));
      const posts = await res.json();
      if(Array.isArray(posts)) {
        posts.forEach(p => {
          state.postsCache[p.id] = p;
          const card = createCardNode(p);
          grid.appendChild(card);
        });
      }
      document.getElementById('editorPostsLoading').textContent = '';

      if(updateURL) {
        const newUrl = `${window.location.origin}${window.location.pathname}?editor=${user.id}`;
        history.pushState({page:'editor', id:user.id}, '', newUrl);
      }
    } catch(e) {
      console.error(e);
      document.getElementById('editorPostsLoading').textContent = 'Î∂àÎü¨Ïò§Í∏∞ Ïã§Ìå®';
    }
  }
};
async function openNavlessSearch(updateURL = true) {
  await showPageTransition();
  const overlay = document.getElementById('searchOverlay');
  
  // Ïò§Î≤ÑÎ†àÏù¥Î•º ÌôúÏÑ±ÌôîÌïòÍ∏∞ Ï†ÑÏóê Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏúÑÎ°ú
  overlay.scrollTop = 0;
  overlay.classList.add('active');
  
  if(window.innerWidth <= 680) {
    document.body.style.overflow = 'hidden';
  }
  document.getElementById('searchInput').focus();
  if(updateURL) {
    const newUrl = `${window.location.origin}${window.location.pathname}?page=search`;
    history.pushState({page:'search'}, '', newUrl);
  }
}
function closeSearch() {
  showPageTransition().then(() => {
    document.getElementById('searchOverlay').classList.remove('active');
    document.body.style.overflow = '';
    document.getElementById('searchResults').innerHTML = '';
    document.getElementById('searchInput').value = '';
    const newUrl = `${window.location.origin}${window.location.pathname}`;
    history.pushState({page:'home'}, '', newUrl);
  });
}
document.getElementById('globalNavSearch').addEventListener('keypress', (e) => {
  if(e.key === 'Enter') {
    e.preventDefault();
    const query = e.target.value.trim();
    if(query.length >= 1) {
      ui.toggleNav(true);
      openSearchWithQuery(query);
    }
  }
});
document.getElementById('searchInput').addEventListener('input', (e) => {
  clearTimeout(state.searchDebounce);
  const query = e.target.value.trim();
  if(query.length < 2) {
    document.getElementById('searchResults').innerHTML = '';
    document.getElementById('searchLoading').textContent = '';
    return;
  }

  state.searchDebounce = setTimeout(() => {
    performSearch(query, 'fullSearch');
  }, 500);
});
async function performSearch(query, mode) {
  if(mode === 'fullSearch') {
    const resultsEl = document.getElementById('searchResults');
    const loadingEl = document.getElementById('searchLoading');
    resultsEl.innerHTML = '';
    loadingEl.textContent = 'Í≤ÄÏÉâ Ï§ë...';

    try {
      const res = await fetch(api(`posts?search=${encodeURIComponent(query)}&per_page=20`));
      const posts = await res.json();

      loadingEl.textContent = '';

      if(Array.isArray(posts) && posts.length > 0) {
        const uniquePosts = posts.filter((post, index, self) =>
          index === self.findIndex(p => p.id === post.id)
        );

        uniquePosts.forEach(p => {
          state.postsCache[p.id] = p;
          const card = createCardNode(p);
          resultsEl.appendChild(card);
        });
      } else {
        loadingEl.textContent = 'Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.';
      }
    } catch(e) {
      console.error(e);
      loadingEl.textContent = 'Í≤ÄÏÉâ Ïã§Ìå®';
    }
  }
}
async function openSearchWithQuery(query) {
  await showPageTransition();
  const overlay = document.getElementById('searchOverlay');
  
  // Ïò§Î≤ÑÎ†àÏù¥Î•º ÌôúÏÑ±ÌôîÌïòÍ∏∞ Ï†ÑÏóê Ïä§ÌÅ¨Î°§ÏùÑ Îß® ÏúÑÎ°ú
  overlay.scrollTop = 0;
  overlay.classList.add('active');
  
  if(window.innerWidth <= 680) {
    document.body.style.overflow = 'hidden';
  }

  const searchInput = document.getElementById('searchInput');
  searchInput.value = query;

  performSearch(query, 'fullSearch');
}
function checkURLAndLoadPost() {
  const urlParams = new URLSearchParams(window.location.search);
  const postParam = urlParams.get('post');
  const categoryParam = urlParams.get('category');
  const editorParam = urlParams.get('editor');
  const pageParam = urlParams.get('page');

  if(postParam) {
    const postId = parseInt(postParam);
    if(!isNaN(postId)) {
      openPostOverlayById(postId, false);
      return true;
    }
  }

  if(categoryParam) {
    router.openCategory(categoryParam, false);
    return true;
  }

  if(editorParam) {
    const editorId = parseInt(editorParam);
    if(!isNaN(editorId)) {
      router.openEditors(false);
      setTimeout(async () => {
        if(state.editorsList.length === 0) {
          await loadEditors();
        }
        const editor = state.editorsList.find(e => e.id === editorId);
        if(editor) {
          router.openEditorProfile(editor, false);
        }
      }, 300);
      return true;
    }
  }

  if(pageParam === 'editors') {
    router.openEditors(false);
    return true;
  } else if(pageParam === 'about') {
    router.openAbout(false);
    return true;
  } else if(pageParam === 'search') {
    openNavlessSearch(false);
    return true;
  }

  const hash = window.location.hash;

  if(hash.startsWith('#post-')) {
    const postId = hash.replace('#post-', '');
    if(postId && !isNaN(parseInt(postId))) {
      const newUrl = `${window.location.origin}${window.location.pathname}?post=${postId}`;
      history.replaceState({page: 'post', id: parseInt(postId)}, '', newUrl);
      setTimeout(() => {
        openPostOverlayById(parseInt(postId), false);
      }, 100);
      return true;
    }
  } else if(hash.startsWith('#editor-')) {
    const editorId = hash.replace('#editor-', '');
    if(editorId && !isNaN(parseInt(editorId))) {
      const newUrl = `${window.location.origin}${window.location.pathname}?editor=${editorId}`;
      history.replaceState({page: 'editor', id: parseInt(editorId)}, '', newUrl);
      router.openEditorProfile(parseInt(editorId), false);
      return true;
    }
  } else if(hash === '#editors') {
    const newUrl = `${window.location.origin}${window.location.pathname}?page=editors`;
    history.replaceState({page: 'editors'}, '', newUrl);
    router.openEditors(false);
    return true;
  } else if(hash === '#about') {
    const newUrl = `${window.location.origin}${window.location.pathname}?page=about`;
    history.replaceState({page: 'about'}, '', newUrl);
    router.openAbout(false);
    return true;
  } else if(hash === '#search') {
    const newUrl = `${window.location.origin}${window.location.pathname}?page=search`;
    history.replaceState({page: 'search'}, '', newUrl);
    openNavlessSearch(false);
    return true;
  }

  return false;
}
window.addEventListener('popstate', (e) => {
  const urlParams = new URLSearchParams(window.location.search);
  const postParam = urlParams.get('post');
  const categoryParam = urlParams.get('category');
  const editorParam = urlParams.get('editor');
  const pageParam = urlParams.get('page');

  if(postParam) {
    const postId = parseInt(postParam);
    if(!isNaN(postId)) {
      setTimeout(() => {
        openPostOverlayById(postId, false);
      }, 50);
      return;
    }
  }

  if(categoryParam) {
    document.querySelectorAll('.post-overlay, .search-overlay, .about-page, .editors-overlay').forEach(el => {
      el.classList.remove('active');
    });
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');

    router.openCategory(categoryParam, false);
    return;
  }

  if(editorParam) {
    const editorId = parseInt(editorParam);
    if(!isNaN(editorId)) {
      document.querySelectorAll('.post-overlay, .search-overlay, .about-page, .category-overlay').forEach(el => {
        el.classList.remove('active');
      });
      document.body.style.overflow = '';
      document.getElementById('progressBar').classList.remove('active');
      document.getElementById('postHeaderBar').classList.remove('show');
      document.getElementById('postToTopBtn').classList.remove('show');

      if(!document.getElementById('editorsOverlay').classList.contains('active')) {
        router.openEditors(false);
      }

      setTimeout(async () => {
        if(state.editorsList.length === 0) {
          await loadEditors();
        }
        const editor = state.editorsList.find(e => e.id === editorId);
        if(editor) {
          router.openEditorProfile(editor, false);
        }
      }, 100);
      return;
    }
  }

  if(pageParam === 'editors') {
    document.querySelectorAll('.post-overlay, .search-overlay, .about-page, .category-overlay').forEach(el => {
      el.classList.remove('active');
    });
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');

    router.openEditors(false);
    return;
  } else if(pageParam === 'about') {
    document.querySelectorAll('.post-overlay, .search-overlay, .editors-overlay, .category-overlay').forEach(el => {
      el.classList.remove('active');
    });
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');

    router.openAbout(false);
    return;
  } else if(pageParam === 'search') {
    document.querySelectorAll('.post-overlay, .about-page, .editors-overlay, .category-overlay').forEach(el => {
      el.classList.remove('active');
    });
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');

    openNavlessSearch(false);
    return;
  }

  if(!postParam && !categoryParam && !editorParam && !pageParam) {
    document.querySelectorAll('.category-overlay, .post-overlay, .search-overlay, .about-page, .editors-overlay').forEach(el => {
      el.classList.remove('active');
    });
    document.body.style.overflow = '';
    document.getElementById('progressBar').classList.remove('active');
    document.getElementById('postHeaderBar').classList.remove('show');
    document.getElementById('postToTopBtn').classList.remove('show');
  }
});

document.getElementById('imageModal').addEventListener('click', (e) => {
  if(e.target.id === 'imageModal' || e.target.classList.contains('image-modal')) {
    closeImageModal();
  }
});

document.addEventListener('DOMContentLoaded', () => {
  renderNavList();

  const loadingEl = document.getElementById('homeLoading');
  loadingEl.textContent = 'ÌéòÏù¥ÏßÄÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë...';

  const hasSpecificPage = checkURLAndLoadPost();

  if(!hasSpecificPage) {
    loadHomeChunk(1)
      .then(() => {
        console.log('Home loaded successfully');
      })
      .catch((err) => {
        console.error('Home loading failed:', err);
        loadingEl.textContent = 'ÌéòÏù¥ÏßÄÎ•º Î∂àÎü¨Ïò§ÏßÄ Î™ªÌñàÏäµÎãàÎã§. ÏÉàÎ°úÍ≥†Ïπ®ÏùÑ ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
      });
  } else {
    loadingEl.textContent = '';
  }
});
let resizeTimeout;
window.addEventListener('resize', () => {
  clearTimeout(resizeTimeout);
  resizeTimeout = setTimeout(() => {
    if(!document.getElementById('categoryOverlay').classList.contains('active') &&
       !document.getElementById('postOverlay').classList.contains('active') &&
       !document.getElementById('searchOverlay').classList.contains('active') &&
       !document.getElementById('aboutPage').classList.contains('active') &&
       !document.getElementById('editorsOverlay').classList.contains('active')) {
      state.homeLoadPromise = null;
      loadHomeChunk(state.homePage || 1);
    }
  }, 300);
});
document.addEventListener('keydown', (e) => {
  if(e.key === 'Escape') {
    if(document.getElementById('imageModal').classList.contains('active')) {
      closeImageModal();
    } else if(document.getElementById('postOverlay').classList.contains('active')) {
      router.closePost();
    } else if(document.getElementById('searchOverlay').classList.contains('active')) {
      closeSearch();
    } else if(document.getElementById('categoryOverlay').classList.contains('active')) {
      router.closeCategory();
    } else if(document.getElementById('editorsOverlay').classList.contains('active')) {
      router.closeEditors();
    } else if(document.getElementById('aboutPage').classList.contains('active')) {
      router.closeAbout();
    } else if(document.getElementById('navOverlay').classList.contains('active')) {
      ui.toggleNav(true);
    }
  }
});
</script>
</body>
</html>
